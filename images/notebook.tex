
% Default to the notebook output style

    


% Inherit from the specified cell style.




    
\documentclass[11pt]{article}

    
    
    \usepackage[T1]{fontenc}
    % Nicer default font (+ math font) than Computer Modern for most use cases
    \usepackage{mathpazo}

    % Basic figure setup, for now with no caption control since it's done
    % automatically by Pandoc (which extracts ![](path) syntax from Markdown).
    \usepackage{graphicx}
    % We will generate all images so they have a width \maxwidth. This means
    % that they will get their normal width if they fit onto the page, but
    % are scaled down if they would overflow the margins.
    \makeatletter
    \def\maxwidth{\ifdim\Gin@nat@width>\linewidth\linewidth
    \else\Gin@nat@width\fi}
    \makeatother
    \let\Oldincludegraphics\includegraphics
    % Set max figure width to be 80% of text width, for now hardcoded.
    \renewcommand{\includegraphics}[1]{\Oldincludegraphics[width=.8\maxwidth]{#1}}
    % Ensure that by default, figures have no caption (until we provide a
    % proper Figure object with a Caption API and a way to capture that
    % in the conversion process - todo).
    \usepackage{caption}
    \DeclareCaptionLabelFormat{nolabel}{}
    \captionsetup{labelformat=nolabel}

    \usepackage{adjustbox} % Used to constrain images to a maximum size 
    \usepackage{xcolor} % Allow colors to be defined
    \usepackage{enumerate} % Needed for markdown enumerations to work
    \usepackage{geometry} % Used to adjust the document margins
    \usepackage{amsmath} % Equations
    \usepackage{amssymb} % Equations
    \usepackage{textcomp} % defines textquotesingle
    % Hack from http://tex.stackexchange.com/a/47451/13684:
    \AtBeginDocument{%
        \def\PYZsq{\textquotesingle}% Upright quotes in Pygmentized code
    }
    \usepackage{upquote} % Upright quotes for verbatim code
    \usepackage{eurosym} % defines \euro
    \usepackage[mathletters]{ucs} % Extended unicode (utf-8) support
    \usepackage[utf8x]{inputenc} % Allow utf-8 characters in the tex document
    \usepackage{fancyvrb} % verbatim replacement that allows latex
    \usepackage{grffile} % extends the file name processing of package graphics 
                         % to support a larger range 
    % The hyperref package gives us a pdf with properly built
    % internal navigation ('pdf bookmarks' for the table of contents,
    % internal cross-reference links, web links for URLs, etc.)
    \usepackage{hyperref}
    \usepackage{longtable} % longtable support required by pandoc >1.10
    \usepackage{booktabs}  % table support for pandoc > 1.12.2
    \usepackage[inline]{enumitem} % IRkernel/repr support (it uses the enumerate* environment)
    \usepackage[normalem]{ulem} % ulem is needed to support strikethroughs (\sout)
                                % normalem makes italics be italics, not underlines
    

    
    
    % Colors for the hyperref package
    \definecolor{urlcolor}{rgb}{0,.145,.698}
    \definecolor{linkcolor}{rgb}{.71,0.21,0.01}
    \definecolor{citecolor}{rgb}{.12,.54,.11}

    % ANSI colors
    \definecolor{ansi-black}{HTML}{3E424D}
    \definecolor{ansi-black-intense}{HTML}{282C36}
    \definecolor{ansi-red}{HTML}{E75C58}
    \definecolor{ansi-red-intense}{HTML}{B22B31}
    \definecolor{ansi-green}{HTML}{00A250}
    \definecolor{ansi-green-intense}{HTML}{007427}
    \definecolor{ansi-yellow}{HTML}{DDB62B}
    \definecolor{ansi-yellow-intense}{HTML}{B27D12}
    \definecolor{ansi-blue}{HTML}{208FFB}
    \definecolor{ansi-blue-intense}{HTML}{0065CA}
    \definecolor{ansi-magenta}{HTML}{D160C4}
    \definecolor{ansi-magenta-intense}{HTML}{A03196}
    \definecolor{ansi-cyan}{HTML}{60C6C8}
    \definecolor{ansi-cyan-intense}{HTML}{258F8F}
    \definecolor{ansi-white}{HTML}{C5C1B4}
    \definecolor{ansi-white-intense}{HTML}{A1A6B2}

    % commands and environments needed by pandoc snippets
    % extracted from the output of `pandoc -s`
    \providecommand{\tightlist}{%
      \setlength{\itemsep}{0pt}\setlength{\parskip}{0pt}}
    \DefineVerbatimEnvironment{Highlighting}{Verbatim}{commandchars=\\\{\}}
    % Add ',fontsize=\small' for more characters per line
    \newenvironment{Shaded}{}{}
    \newcommand{\KeywordTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\DataTypeTok}[1]{\textcolor[rgb]{0.56,0.13,0.00}{{#1}}}
    \newcommand{\DecValTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\BaseNTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\FloatTok}[1]{\textcolor[rgb]{0.25,0.63,0.44}{{#1}}}
    \newcommand{\CharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\StringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\CommentTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textit{{#1}}}}
    \newcommand{\OtherTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{{#1}}}
    \newcommand{\AlertTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\FunctionTok}[1]{\textcolor[rgb]{0.02,0.16,0.49}{{#1}}}
    \newcommand{\RegionMarkerTok}[1]{{#1}}
    \newcommand{\ErrorTok}[1]{\textcolor[rgb]{1.00,0.00,0.00}{\textbf{{#1}}}}
    \newcommand{\NormalTok}[1]{{#1}}
    
    % Additional commands for more recent versions of Pandoc
    \newcommand{\ConstantTok}[1]{\textcolor[rgb]{0.53,0.00,0.00}{{#1}}}
    \newcommand{\SpecialCharTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\VerbatimStringTok}[1]{\textcolor[rgb]{0.25,0.44,0.63}{{#1}}}
    \newcommand{\SpecialStringTok}[1]{\textcolor[rgb]{0.73,0.40,0.53}{{#1}}}
    \newcommand{\ImportTok}[1]{{#1}}
    \newcommand{\DocumentationTok}[1]{\textcolor[rgb]{0.73,0.13,0.13}{\textit{{#1}}}}
    \newcommand{\AnnotationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\CommentVarTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\VariableTok}[1]{\textcolor[rgb]{0.10,0.09,0.49}{{#1}}}
    \newcommand{\ControlFlowTok}[1]{\textcolor[rgb]{0.00,0.44,0.13}{\textbf{{#1}}}}
    \newcommand{\OperatorTok}[1]{\textcolor[rgb]{0.40,0.40,0.40}{{#1}}}
    \newcommand{\BuiltInTok}[1]{{#1}}
    \newcommand{\ExtensionTok}[1]{{#1}}
    \newcommand{\PreprocessorTok}[1]{\textcolor[rgb]{0.74,0.48,0.00}{{#1}}}
    \newcommand{\AttributeTok}[1]{\textcolor[rgb]{0.49,0.56,0.16}{{#1}}}
    \newcommand{\InformationTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    \newcommand{\WarningTok}[1]{\textcolor[rgb]{0.38,0.63,0.69}{\textbf{\textit{{#1}}}}}
    
    
    % Define a nice break command that doesn't care if a line doesn't already
    % exist.
    \def\br{\hspace*{\fill} \\* }
    % Math Jax compatability definitions
    \def\gt{>}
    \def\lt{<}
    % Document parameters
    \title{Arvato Project Workbook}
    
    
    

    % Pygments definitions
    
\makeatletter
\def\PY@reset{\let\PY@it=\relax \let\PY@bf=\relax%
    \let\PY@ul=\relax \let\PY@tc=\relax%
    \let\PY@bc=\relax \let\PY@ff=\relax}
\def\PY@tok#1{\csname PY@tok@#1\endcsname}
\def\PY@toks#1+{\ifx\relax#1\empty\else%
    \PY@tok{#1}\expandafter\PY@toks\fi}
\def\PY@do#1{\PY@bc{\PY@tc{\PY@ul{%
    \PY@it{\PY@bf{\PY@ff{#1}}}}}}}
\def\PY#1#2{\PY@reset\PY@toks#1+\relax+\PY@do{#2}}

\expandafter\def\csname PY@tok@w\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.73,0.73}{##1}}}
\expandafter\def\csname PY@tok@c\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.74,0.48,0.00}{##1}}}
\expandafter\def\csname PY@tok@k\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.69,0.00,0.25}{##1}}}
\expandafter\def\csname PY@tok@o\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ow\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@nb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@nn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@ne\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.82,0.25,0.23}{##1}}}
\expandafter\def\csname PY@tok@nv\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@no\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@nl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@ni\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.60,0.60,0.60}{##1}}}
\expandafter\def\csname PY@tok@na\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.49,0.56,0.16}{##1}}}
\expandafter\def\csname PY@tok@nt\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@nd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.67,0.13,1.00}{##1}}}
\expandafter\def\csname PY@tok@s\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sd\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@si\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@se\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.13}{##1}}}
\expandafter\def\csname PY@tok@sr\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.40,0.53}{##1}}}
\expandafter\def\csname PY@tok@ss\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sx\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@m\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@gh\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gu\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.50,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@gd\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.63,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@gi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.63,0.00}{##1}}}
\expandafter\def\csname PY@tok@gr\endcsname{\def\PY@tc##1{\textcolor[rgb]{1.00,0.00,0.00}{##1}}}
\expandafter\def\csname PY@tok@ge\endcsname{\let\PY@it=\textit}
\expandafter\def\csname PY@tok@gs\endcsname{\let\PY@bf=\textbf}
\expandafter\def\csname PY@tok@gp\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,0.50}{##1}}}
\expandafter\def\csname PY@tok@go\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.53,0.53,0.53}{##1}}}
\expandafter\def\csname PY@tok@gt\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.27,0.87}{##1}}}
\expandafter\def\csname PY@tok@err\endcsname{\def\PY@bc##1{\setlength{\fboxsep}{0pt}\fcolorbox[rgb]{1.00,0.00,0.00}{1,1,1}{\strut ##1}}}
\expandafter\def\csname PY@tok@kc\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kd\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kn\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@kr\endcsname{\let\PY@bf=\textbf\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@bp\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.50,0.00}{##1}}}
\expandafter\def\csname PY@tok@fm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.00,0.00,1.00}{##1}}}
\expandafter\def\csname PY@tok@vc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vg\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@vm\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.10,0.09,0.49}{##1}}}
\expandafter\def\csname PY@tok@sa\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sc\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@dl\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s2\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@sh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@s1\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.73,0.13,0.13}{##1}}}
\expandafter\def\csname PY@tok@mb\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mf\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mh\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mi\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@il\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@mo\endcsname{\def\PY@tc##1{\textcolor[rgb]{0.40,0.40,0.40}{##1}}}
\expandafter\def\csname PY@tok@ch\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cm\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cpf\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@c1\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}
\expandafter\def\csname PY@tok@cs\endcsname{\let\PY@it=\textit\def\PY@tc##1{\textcolor[rgb]{0.25,0.50,0.50}{##1}}}

\def\PYZbs{\char`\\}
\def\PYZus{\char`\_}
\def\PYZob{\char`\{}
\def\PYZcb{\char`\}}
\def\PYZca{\char`\^}
\def\PYZam{\char`\&}
\def\PYZlt{\char`\<}
\def\PYZgt{\char`\>}
\def\PYZsh{\char`\#}
\def\PYZpc{\char`\%}
\def\PYZdl{\char`\$}
\def\PYZhy{\char`\-}
\def\PYZsq{\char`\'}
\def\PYZdq{\char`\"}
\def\PYZti{\char`\~}
% for compatibility with earlier versions
\def\PYZat{@}
\def\PYZlb{[}
\def\PYZrb{]}
\makeatother


    % Exact colors from NB
    \definecolor{incolor}{rgb}{0.0, 0.0, 0.5}
    \definecolor{outcolor}{rgb}{0.545, 0.0, 0.0}



    
    % Prevent overflowing lines due to hard-to-break entities
    \sloppy 
    % Setup hyperref package
    \hypersetup{
      breaklinks=true,  % so long urls are correctly broken across lines
      colorlinks=true,
      urlcolor=urlcolor,
      linkcolor=linkcolor,
      citecolor=citecolor,
      }
    % Slightly bigger margins than the latex defaults
    
    \geometry{verbose,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}
    
    

    \begin{document}
    
    
    \maketitle
    
    

    
    \section{Capstone Project: Create a Customer Segmentation Report for
Arvato Financial
Services}\label{capstone-project-create-a-customer-segmentation-report-for-arvato-financial-services}

In this project, you will analyze demographics data for customers of a
mail-order sales company in Germany, comparing it against demographics
information for the general population. You'll use unsupervised learning
techniques to perform customer segmentation, identifying the parts of
the population that best describe the core customer base of the company.
Then, you'll apply what you've learned on a third dataset with
demographics information for targets of a marketing campaign for the
company, and use a model to predict which individuals are most likely to
convert into becoming customers for the company. The data that you will
use has been provided by our partners at Bertelsmann Arvato Analytics,
and represents a real-life data science task.

If you completed the first term of this program, you will be familiar
with the first part of this project, from the unsupervised learning
project. The versions of those two datasets used in this project will
include many more features and has not been pre-cleaned. You are also
free to choose whatever approach you'd like to analyzing the data rather
than follow pre-determined steps. In your work on this project, make
sure that you carefully document your steps and decisions, since your
main deliverable for this project will be a blog post reporting your
findings.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}1}]:} \PY{c+c1}{\PYZsh{} import libraries here; add more as necessary}
        \PY{k+kn}{import} \PY{n+nn}{numpy} \PY{k}{as} \PY{n+nn}{np}
        \PY{k+kn}{import} \PY{n+nn}{pandas} \PY{k}{as} \PY{n+nn}{pd}
        \PY{k+kn}{import} \PY{n+nn}{matplotlib}\PY{n+nn}{.}\PY{n+nn}{pyplot} \PY{k}{as} \PY{n+nn}{plt}
        \PY{k+kn}{import} \PY{n+nn}{seaborn} \PY{k}{as} \PY{n+nn}{sns}
        \PY{k+kn}{import} \PY{n+nn}{random}
        \PY{k+kn}{import} \PY{n+nn}{pickle}
        
        \PY{c+c1}{\PYZsh{}from sklearn.impute import SimpleImputer}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{preprocessing} \PY{k}{import} \PY{n}{Imputer}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{decomposition} \PY{k}{import} \PY{n}{PCA}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{model\PYZus{}selection} \PY{k}{import} \PY{n}{train\PYZus{}test\PYZus{}split}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{metrics} \PY{k}{import} \PY{n}{roc\PYZus{}auc\PYZus{}score}\PY{p}{,} \PY{n}{fbeta\PYZus{}score}\PY{p}{,} \PY{n}{accuracy\PYZus{}score}\PY{p}{,} \PY{n}{precision\PYZus{}score}\PY{p}{,} \PY{n}{recall\PYZus{}score}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{model\PYZus{}selection} \PY{k}{import} \PY{n}{GridSearchCV}\PY{p}{,} \PY{n}{StratifiedKFold}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{linear\PYZus{}model} \PY{k}{import} \PY{n}{LogisticRegression}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{preprocessing} \PY{k}{import} \PY{n}{StandardScaler}\PY{p}{,} \PY{n}{MinMaxScaler}
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{ensemble} \PY{k}{import} \PY{n}{AdaBoostClassifier}\PY{p}{,} \PY{n}{GradientBoostingClassifier}
        
        \PY{k+kn}{from} \PY{n+nn}{sklearn}\PY{n+nn}{.}\PY{n+nn}{cluster} \PY{k}{import} \PY{n}{KMeans}
        \PY{k+kn}{import} \PY{n+nn}{lightgbm} \PY{k}{as} \PY{n+nn}{lgb}
        \PY{k+kn}{import} \PY{n+nn}{xgboost} \PY{k}{as} \PY{n+nn}{xgb}
        
        \PY{c+c1}{\PYZsh{} magic word for producing visualizations in notebook}
        \PY{o}{\PYZpc{}}\PY{k}{matplotlib} inline
\end{Verbatim}


    \subsection{Part 0: Get to Know the
Data}\label{part-0-get-to-know-the-data}

There are four data files associated with this project:

\begin{itemize}
\tightlist
\item
  \texttt{Udacity\_AZDIAS\_052018.csv}: Demographics data for the
  general population of Germany; 891 211 persons (rows) x 366 features
  (columns).
\item
  \texttt{Udacity\_CUSTOMERS\_052018.csv}: Demographics data for
  customers of a mail-order company; 191 652 persons (rows) x 369
  features (columns).
\item
  \texttt{Udacity\_MAILOUT\_052018\_TRAIN.csv}: Demographics data for
  individuals who were targets of a marketing campaign; 42 982 persons
  (rows) x 367 (columns).
\item
  \texttt{Udacity\_MAILOUT\_052018\_TEST.csv}: Demographics data for
  individuals who were targets of a marketing campaign; 42 833 persons
  (rows) x 366 (columns).
\end{itemize}

Each row of the demographics files represents a single person, but also
includes information outside of individuals, including information about
their household, building, and neighborhood. Use the information from
the first two files to figure out how customers ("CUSTOMERS") are
similar to or differ from the general population at large ("AZDIAS"),
then use your analysis to make predictions on the other two files
("MAILOUT"), predicting which recipients are most likely to become a
customer for the mail-order company.

The "CUSTOMERS" file contains three extra columns ('CUSTOMER\_GROUP',
'ONLINE\_PURCHASE', and 'PRODUCT\_GROUP'), which provide broad
information about the customers depicted in the file. The original
"MAILOUT" file included one additional column, "RESPONSE", which
indicated whether or not each recipient became a customer of the
company. For the "TRAIN" subset, this column has been retained, but in
the "TEST" subset it has been removed; it is against that withheld
column that your final predictions will be assessed in the Kaggle
competition.

Otherwise, all of the remaining columns are the same between the three
data files. For more information about the columns depicted in the
files, you can refer to two Excel spreadsheets provided in the
workspace.
\href{./DIAS\%20Information\%20Levels\%20-\%20Attributes\%202017.xlsx}{One
of them} is a top-level list of attributes and descriptions, organized
by informational category.
\href{./DIAS\%20Attributes\%20-\%20Values\%202017.xlsx}{The other} is a
detailed mapping of data values for each feature in alphabetical order.

In the below cell, we've provided some initial code to load in the first
two datasets. Note for all of the \texttt{.csv} data files in this
project that they're semicolon (\texttt{;}) delimited, so an additional
argument in the
\href{https://pandas.pydata.org/pandas-docs/stable/generated/pandas.read_csv.html}{\texttt{read\_csv()}}
call has been included to read in the data properly. Also, considering
the size of the datasets, it may take some time for them to load
completely.

You'll notice when the data is loaded in that a warning message will
immediately pop up. Before you really start digging into the modeling
and analysis, you're going to need to perform some cleaning. Take some
time to browse the structure of the data and look over the informational
spreadsheets to understand the data values. Make some decisions on which
features to keep, which features to drop, and if any revisions need to
be made on data formats. It'll be a good idea to create a function with
pre-processing steps, since you'll need to clean all of the datasets
before you work with them.

    I was facing issues handling azdias dataset (timeout/ workspace is idle
etc.). I decided to use sample azdias instead of the complete dataset.
The size of the sample is roughly the 1/4 of the original azdias
dataset.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}2}]:} \PY{n}{f} \PY{o}{=} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{../../data/Term2/capstone/arvato\PYZus{}data/Udacity\PYZus{}AZDIAS\PYZus{}052018.csv}\PY{l+s+s1}{\PYZsq{}}
        \PY{n}{num\PYZus{}lines} \PY{o}{=} \PY{n+nb}{sum}\PY{p}{(}\PY{l+m+mi}{1} \PY{k}{for} \PY{n}{l} \PY{o+ow}{in} \PY{n+nb}{open}\PY{p}{(}\PY{n}{f}\PY{p}{)}\PY{p}{)}
        
        \PY{n}{size} \PY{o}{=} \PY{n+nb}{int}\PY{p}{(}\PY{n}{num\PYZus{}lines}\PY{o}{/}\PY{l+m+mi}{4}\PY{p}{)}
        \PY{n}{skip\PYZus{}idx} \PY{o}{=} \PY{n}{random}\PY{o}{.}\PY{n}{sample}\PY{p}{(}\PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{num\PYZus{}lines}\PY{p}{)}\PY{p}{,}\PY{n}{num\PYZus{}lines} \PY{o}{\PYZhy{}} \PY{n}{size}\PY{p}{)}
        \PY{n}{azdias} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{../../data/Term2/capstone/arvato\PYZus{}data/Udacity\PYZus{}AZDIAS\PYZus{}052018.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{sep}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{;}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{skiprows}\PY{o}{=}\PY{n}{skip\PYZus{}idx}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
/opt/conda/lib/python3.6/site-packages/IPython/core/interactiveshell.py:2785: DtypeWarning: Columns (18,19) have mixed types. Specify dtype option on import or set low\_memory=False.
  interactivity=interactivity, compiler=compiler, result=result)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}3}]:} \PY{c+c1}{\PYZsh{} load in the data}
        \PY{n}{customers} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{../../data/Term2/capstone/arvato\PYZus{}data/Udacity\PYZus{}CUSTOMERS\PYZus{}052018.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{sep}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{;}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
/opt/conda/lib/python3.6/site-packages/IPython/core/interactiveshell.py:2785: DtypeWarning: Columns (18,19) have mixed types. Specify dtype option on import or set low\_memory=False.
  interactivity=interactivity, compiler=compiler, result=result)

    \end{Verbatim}

    One thing to notice after loading both azdias and customers dataset is
columns 18 and 19 are of mixed types. Let's see which columns are column
18 and 19

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}4}]:} \PY{n}{azdias}\PY{o}{.}\PY{n}{columns}\PY{p}{[}\PY{l+m+mi}{18}\PY{p}{:}\PY{l+m+mi}{20}\PY{p}{]}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}4}]:} Index(['CAMEO\_DEUG\_2015', 'CAMEO\_INTL\_2015'], dtype='object')
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}5}]:} \PY{n}{azdias}\PY{o}{.}\PY{n}{CAMEO\PYZus{}DEUG\PYZus{}2015}\PY{o}{.}\PY{n}{value\PYZus{}counts}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}5}]:} 8      19715
        9      16016
        6      15640
        4      15241
        8.0    13919
        3      12611
        2      12189
        7      11392
        9.0    11107
        6.0    10930
        4.0    10666
        3.0     8949
        2.0     8603
        5       8184
        7.0     8006
        5.0     5741
        1       5295
        1.0     3763
        X         96
        Name: CAMEO\_DEUG\_2015, dtype: int64
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}6}]:} \PY{n}{azdias}\PY{o}{.}\PY{n}{CAMEO\PYZus{}INTL\PYZus{}2015}\PY{o}{.}\PY{n}{value\PYZus{}counts}\PY{p}{(}\PY{l+m+mi}{0}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}6}]:} 51      19724
        51.0    13824
        41      13509
        24      13281
        41.0     9544
        24.0     9444
        14       9265
        43       8273
        54       6669
        14.0     6496
        43.0     5858
        25       5789
        22       4819
        54.0     4601
        25.0     4004
        23       3963
        45       3880
        13       3848
        55       3563
        22.0     3408
        52       2967
        31       2830
        34       2786
        23.0     2759
        13.0     2745
        45.0     2692
        15       2455
        55.0     2442
        44       2243
        52.0     2159
        31.0     1997
        34.0     1917
        12       1916
        15.0     1755
        35       1527
        44.0     1502
        32       1494
        33       1482
        12.0     1370
        35.0     1099
        33.0     1045
        32.0     1023
        XX         96
        Name: CAMEO\_INTL\_2015, dtype: int64
\end{Verbatim}
            
    We need to replace X in CAMEO\_DEUG\_2015 and rows with value XX in
CAMEO\_INTL\_2015 from both azdias and customers dataset. Also, notice
in CAMEO\_DEUG\_2015 and CAMEO\_DEUG\_2015, 1 and 1.0 is same, as they
represent the same class.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}7}]:} \PY{k}{def} \PY{n+nf}{mixed\PYZus{}feature\PYZus{}handler}\PY{p}{(}\PY{n}{df}\PY{p}{)}\PY{p}{:}
            \PY{l+s+sd}{\PYZsq{}\PYZsq{}\PYZsq{}}
        \PY{l+s+sd}{    This function deals with the special characters in the cameo columns}
        \PY{l+s+sd}{    Finds the special characters and replaces them with nan}
        \PY{l+s+sd}{    \PYZsq{}\PYZsq{}\PYZsq{}}
            
            \PY{n}{cols} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{CAMEO\PYZus{}DEUG\PYZus{}2015}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{CAMEO\PYZus{}INTL\PYZus{}2015}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
            \PY{n}{df}\PY{p}{[}\PY{n}{cols}\PY{p}{]} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{n}{cols}\PY{p}{]}\PY{o}{.}\PY{n}{replace}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{X}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{np}\PY{o}{.}\PY{n}{nan}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{XX}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{np}\PY{o}{.}\PY{n}{nan}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{n}{np}\PY{o}{.}\PY{n}{nan}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ }\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{np}\PY{o}{.}\PY{n}{nan}\PY{p}{\PYZcb{}}\PY{p}{)}
            \PY{n}{df}\PY{p}{[}\PY{n}{cols}\PY{p}{]} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{n}{cols}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{float}\PY{p}{)}
               
            \PY{k}{return} \PY{n}{df}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}8}]:} \PY{n}{azdias} \PY{o}{=} \PY{n}{mixed\PYZus{}feature\PYZus{}handler}\PY{p}{(}\PY{n}{azdias}\PY{p}{)}
        \PY{n}{customer} \PY{o}{=} \PY{n}{mixed\PYZus{}feature\PYZus{}handler}\PY{p}{(}\PY{n}{customers}\PY{p}{)}
        
        \PY{n}{azdias}\PY{o}{.}\PY{n}{CAMEO\PYZus{}INTL\PYZus{}2015}\PY{o}{.}\PY{n}{value\PYZus{}counts}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}8}]:} 51.0    33548
        41.0    23053
        24.0    22725
        14.0    15761
        43.0    14131
        54.0    11270
        25.0     9793
        22.0     8227
        23.0     6722
        13.0     6593
        45.0     6572
        55.0     6005
        52.0     5126
        31.0     4827
        34.0     4703
        15.0     4210
        44.0     3745
        12.0     3286
        35.0     2626
        33.0     2527
        32.0     2517
        Name: CAMEO\_INTL\_2015, dtype: int64
\end{Verbatim}
            
    \subparagraph{Getting some basic stats related to azdias dataset - like
shape, mean, standard deviation, different
percentiles}\label{getting-some-basic-stats-related-to-azdias-dataset---like-shape-mean-standard-deviation-different-percentiles}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}9}]:} \PY{n}{azdias}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}9}]:} (222804, 366)
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}10}]:} \PY{n}{azdias}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}10}]:}       LNR  AGER\_TYP  AKT\_DAT\_KL  ALTER\_HH  ALTER\_KIND1  ALTER\_KIND2  \textbackslash{}
         0  910215        -1         NaN       NaN          NaN          NaN   
         1  910220        -1         9.0       0.0          NaN          NaN   
         2  910225        -1         9.0      17.0          NaN          NaN   
         3  910241        -1         1.0      20.0          NaN          NaN   
         4  645165         0         1.0      10.0          NaN          NaN   
         
            ALTER\_KIND3  ALTER\_KIND4  ALTERSKATEGORIE\_FEIN  ANZ\_HAUSHALTE\_AKTIV  \textbackslash{}
         0          NaN          NaN                   NaN                  NaN   
         1          NaN          NaN                  21.0                 11.0   
         2          NaN          NaN                  17.0                 10.0   
         3          NaN          NaN                  14.0                  3.0   
         4          NaN          NaN                  10.0                  6.0   
         
                    {\ldots}           VHN  VK\_DHT4A  VK\_DISTANZ  VK\_ZG11  W\_KEIT\_KIND\_HH  \textbackslash{}
         0          {\ldots}           NaN       NaN         NaN      NaN             NaN   
         1          {\ldots}           4.0       8.0        11.0     10.0             3.0   
         2          {\ldots}           2.0       9.0         9.0      6.0             3.0   
         3          {\ldots}           2.0       3.0         5.0      4.0             2.0   
         4          {\ldots}           4.0       8.0        11.0     10.0             6.0   
         
            WOHNDAUER\_2008  WOHNLAGE ZABEOTYP  ANREDE\_KZ  ALTERSKATEGORIE\_GROB  
         0             NaN       NaN        3          1                     2  
         1             9.0       4.0        5          2                     1  
         2             9.0       2.0        5          2                     3  
         3             9.0       3.0        4          1                     3  
         4             9.0       5.0        3          2                     3  
         
         [5 rows x 366 columns]
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}11}]:} \PY{n}{pd}\PY{o}{.}\PY{n}{set\PYZus{}option}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{display.max\PYZus{}rows}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{500}\PY{p}{)}
         \PY{n}{azdias}\PY{o}{.}\PY{n}{describe}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{transpose}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}11}]:}                                 count           mean            std       min  \textbackslash{}
         LNR                          222804.0  637674.774892  257189.616145  191653.0   
         AGER\_TYP                     222804.0      -0.355680       1.201398      -1.0   
         AKT\_DAT\_KL                   204478.0       4.425205       3.638334       1.0   
         ALTER\_HH                     204478.0      10.844829       7.639274       0.0   
         ALTER\_KIND1                   20205.0      11.733284       4.097684       2.0   
         ALTER\_KIND2                    7384.0      13.358749       3.270849       2.0   
         ALTER\_KIND3                    1601.0      14.446596       2.770569       5.0   
         ALTER\_KIND4                     303.0      14.980198       2.533145       8.0   
         ALTERSKATEGORIE\_FEIN         157177.0      13.703004       5.077645       0.0   
         ANZ\_HAUSHALTE\_AKTIV          199536.0       8.290980      15.480665       0.0   
         ANZ\_HH\_TITEL                 198542.0       0.040551       0.330041       0.0   
         ANZ\_KINDER                   204478.0       0.154031       0.503603       0.0   
         ANZ\_PERSONEN                 204478.0       1.721452       1.147865       0.0   
         ANZ\_STATISTISCHE\_HAUSHALTE   199536.0       7.602924      14.268163       0.0   
         ANZ\_TITEL                    204478.0       0.003785       0.064591       0.0   
         ARBEIT                       198530.0       3.167844       1.000997       1.0   
         BALLRAUM                     199391.0       4.143467       2.182606       1.0   
         CAMEO\_DEUG\_2015              197967.0       5.541126       2.489657       1.0   
         CAMEO\_INTL\_2015              197967.0      35.510136      14.026695      12.0   
         CJT\_GESAMTTYP                221570.0       3.635934       1.594860       1.0   
         CJT\_KATALOGNUTZER            221570.0       3.335984       1.493770       1.0   
         CJT\_TYP\_1                    221570.0       3.369906       1.368358       1.0   
         CJT\_TYP\_2                    221570.0       3.196809       1.402499       1.0   
         CJT\_TYP\_3                    221570.0       3.350887       1.397911       1.0   
         CJT\_TYP\_4                    221570.0       3.336341       1.373138       1.0   
         CJT\_TYP\_5                    221570.0       3.361006       1.379326       1.0   
         CJT\_TYP\_6                    221570.0       3.464007       1.329861       1.0   
         D19\_BANKEN\_ANZ\_12            222804.0       0.122229       0.538022       0.0   
         D19\_BANKEN\_ANZ\_24            222804.0       0.219857       0.747748       0.0   
         D19\_BANKEN\_DATUM             222804.0       9.266984       1.735430       1.0   
         D19\_BANKEN\_DIREKT            222804.0       0.898368       2.017182       0.0   
         D19\_BANKEN\_GROSS             222804.0       0.568235       1.643085       0.0   
         D19\_BANKEN\_LOKAL             222804.0       0.106008       0.805706       0.0   
         D19\_BANKEN\_OFFLINE\_DATUM     222804.0       9.927587       0.602294       1.0   
         D19\_BANKEN\_ONLINE\_DATUM      222804.0       9.436931       1.547648       1.0   
         D19\_BANKEN\_ONLINE\_QUOTE\_12   158454.0       0.707322       2.556123       0.0   
         D19\_BANKEN\_REST              222804.0       0.423947       1.508381       0.0   
         D19\_BEKLEIDUNG\_GEH           222804.0       0.466051       1.538975       0.0   
         D19\_BEKLEIDUNG\_REST          222804.0       1.142996       2.265512       0.0   
         D19\_BILDUNG                  222804.0       0.489444       1.645900       0.0   
         D19\_BIO\_OEKO                 222804.0       0.255714       1.247198       0.0   
         D19\_BUCH\_CD                  222804.0       1.583903       2.546708       0.0   
         D19\_DIGIT\_SERV               222804.0       0.198448       1.040899       0.0   
         D19\_DROGERIEARTIKEL          222804.0       0.664315       1.739088       0.0   
         D19\_ENERGIE                  222804.0       0.345366       1.334832       0.0   
         D19\_FREIZEIT                 222804.0       0.595137       1.727717       0.0   
         D19\_GARTEN                   222804.0       0.257100       1.215019       0.0   
         D19\_GESAMT\_ANZ\_12            222804.0       0.797329       1.331440       0.0   
         D19\_GESAMT\_ANZ\_24            222804.0       1.239960       1.728170       0.0   
         D19\_GESAMT\_DATUM             222804.0       7.073921       3.212790       1.0   
         D19\_GESAMT\_OFFLINE\_DATUM     222804.0       9.031849       1.773990       1.0   
         D19\_GESAMT\_ONLINE\_DATUM      222804.0       7.681734       3.038479       1.0   
         D19\_GESAMT\_ONLINE\_QUOTE\_12   158454.0       3.556963       4.656491       0.0   
         D19\_HANDWERK                 222804.0       0.837328       2.114253       0.0   
         D19\_HAUS\_DEKO                222804.0       1.016907       2.142591       0.0   
         D19\_KINDERARTIKEL            222804.0       0.864800       2.071047       0.0   
         D19\_KONSUMTYP                158454.0       5.412063       3.235979       1.0   
         D19\_KONSUMTYP\_MAX            222804.0       5.845564       3.227773       1.0   
         D19\_KOSMETIK                 222804.0       1.022666       2.339955       0.0   
         D19\_LEBENSMITTEL             222804.0       0.317503       1.311415       0.0   
         D19\_LOTTO                    158454.0       1.511265       2.825290       0.0   
         D19\_NAHRUNGSERGAENZUNG       222804.0       0.242877       1.180814       0.0   
         D19\_RATGEBER                 222804.0       0.502051       1.614010       0.0   
         D19\_REISEN                   222804.0       1.050722       2.330838       0.0   
         D19\_SAMMELARTIKEL            222804.0       0.595707       1.799554       0.0   
         D19\_SCHUHE                   222804.0       0.509946       1.432376       0.0   
         D19\_SONSTIGE                 222804.0       2.372224       2.863952       0.0   
         D19\_SOZIALES                 158454.0       0.656853       1.455469       0.0   
         D19\_TECHNIK                  222804.0       1.735543       2.738597       0.0   
         D19\_TELKO\_ANZ\_12             222804.0       0.048895       0.279194       0.0   
         D19\_TELKO\_ANZ\_24             222804.0       0.099092       0.397059       0.0   
         D19\_TELKO\_DATUM              222804.0       9.430051       1.340716       1.0   
         D19\_TELKO\_MOBILE             222804.0       1.013873       2.190031       0.0   
         D19\_TELKO\_OFFLINE\_DATUM      222804.0       9.827189       0.744524       1.0   
         D19\_TELKO\_ONLINE\_DATUM       222804.0       9.982218       0.237406       1.0   
         D19\_TELKO\_ONLINE\_QUOTE\_12    158454.0       0.011568       0.338797       0.0   
         D19\_TELKO\_REST               222804.0       0.776135       1.965680       0.0   
         D19\_TIERARTIKEL              222804.0       0.243954       1.172497       0.0   
         D19\_VERSAND\_ANZ\_12           222804.0       0.604558       1.151479       0.0   
         D19\_VERSAND\_ANZ\_24           222804.0       0.958524       1.530297       0.0   
         D19\_VERSAND\_DATUM            222804.0       7.716643       2.990766       1.0   
         D19\_VERSAND\_OFFLINE\_DATUM    222804.0       9.326210       1.462897       1.0   
         D19\_VERSAND\_ONLINE\_DATUM     222804.0       7.943964       2.941138       1.0   
         D19\_VERSAND\_ONLINE\_QUOTE\_12  158454.0       3.234882       4.582750       0.0   
         D19\_VERSAND\_REST             222804.0       0.828163       1.910112       0.0   
         D19\_VERSI\_ANZ\_12             222804.0       0.113710       0.434661       0.0   
         D19\_VERSI\_ANZ\_24             222804.0       0.207846       0.618472       0.0   
         D19\_VERSI\_DATUM              222804.0       9.141102       1.913027       1.0   
         D19\_VERSI\_OFFLINE\_DATUM      222804.0       9.921617       0.506973       1.0   
         D19\_VERSI\_ONLINE\_DATUM       222804.0       9.976733       0.312854       1.0   
         D19\_VERSI\_ONLINE\_QUOTE\_12    158454.0       0.025736       0.503508       0.0   
         D19\_VERSICHERUNGEN           222804.0       1.261593       2.254801       0.0   
         D19\_VOLLSORTIMENT            222804.0       1.722218       2.601391       0.0   
         D19\_WEIN\_FEINKOST            222804.0       0.378247       1.493366       0.0   
         DSL\_FLAG                     199536.0       0.967344       0.177734       0.0   
         EINGEZOGENAM\_HH\_JAHR         204478.0    2003.747000       7.050081    1986.0   
         EWDICHTE                     199391.0       3.943648       1.717461       1.0   
         EXTSEL992                     59092.0      33.345563      14.483543       1.0   
         FINANZ\_ANLEGER               222804.0       3.032464       1.530623       1.0   
         FINANZ\_HAUSBAUER             222804.0       3.077763       1.353125       1.0   
         FINANZ\_MINIMALIST            222804.0       3.070950       1.321163       1.0   
         FINANZ\_SPARER                222804.0       2.820690       1.465404       1.0   
         FINANZ\_UNAUFFAELLIGER        222804.0       2.875747       1.486920       1.0   
         FINANZ\_VORSORGER             222804.0       3.403013       1.321396       1.0   
         FINANZTYP                    222804.0       3.789995       1.988125       1.0   
         FIRMENDICHTE                 199534.0       3.453361       1.155411       1.0   
         GEBAEUDETYP                  199536.0       2.808501       2.661815       1.0   
         GEBAEUDETYP\_RASTER           199534.0       3.735454       0.925932       1.0   
         GEBURTSJAHR                  222804.0    1103.725831     976.280536       0.0   
         GEMEINDETYP                  198520.0      24.150892      12.021819      11.0   
         GFK\_URLAUBERTYP              221570.0       7.349375       3.526553       1.0   
         GREEN\_AVANTGARDE             222804.0       0.196702       0.397506       0.0   
         HEALTH\_TYP                   222804.0       1.792800       1.268732      -1.0   
         HH\_DELTA\_FLAG                195820.0       0.093428       0.291032       0.0   
         HH\_EINKOMMEN\_SCORE           218216.0       4.209105       1.623280       1.0   
         INNENSTADT                   199391.0       4.540561       2.028843       1.0   
         KBA05\_ALTER1                 189369.0       2.070994       1.536210       0.0   
         KBA05\_ALTER2                 189369.0       3.152512       1.342809       1.0   
         KBA05\_ALTER3                 189369.0       3.108693       1.353115       1.0   
         KBA05\_ALTER4                 189369.0       2.923213       1.501542       0.0   
         KBA05\_ANHANG                 189369.0       1.108244       1.433553       0.0   
         KBA05\_ANTG1                  189369.0       1.493581       1.402738       0.0   
         KBA05\_ANTG2                  189369.0       1.262657       1.244982       0.0   
         KBA05\_ANTG3                  189369.0       0.626972       1.015524       0.0   
         KBA05\_ANTG4                  189369.0       0.305657       0.638045       0.0   
         KBA05\_AUTOQUOT               189369.0       3.206549       1.403085       1.0   
         KBA05\_BAUMAX                 189369.0       1.397568       1.784713       0.0   
         KBA05\_CCM1                   189369.0       3.080985       1.354621       1.0   
         KBA05\_CCM2                   189369.0       3.115357       1.327500       1.0   
         KBA05\_CCM3                   189369.0       3.146444       1.355909       1.0   
         KBA05\_CCM4                   189369.0       1.365414       1.625192       0.0   
         KBA05\_DIESEL                 189369.0       2.152301       1.432181       0.0   
         KBA05\_FRAU                   189369.0       3.112141       1.353589       1.0   
         KBA05\_GBZ                    189369.0       3.158083       1.328126       1.0   
         KBA05\_HERST1                 189369.0       2.480733       1.639758       0.0   
         KBA05\_HERST2                 189369.0       3.104769       1.319509       1.0   
         KBA05\_HERST3                 189369.0       3.033527       1.397068       0.0   
         KBA05\_HERST4                 189369.0       2.953952       1.501053       0.0   
         KBA05\_HERST5                 189369.0       2.924618       1.542792       0.0   
         KBA05\_HERSTTEMP              199536.0       2.835669       1.491183       1.0   
         KBA05\_KRSAQUOT               189369.0       3.098173       1.397789       1.0   
         KBA05\_KRSHERST1              189369.0       3.053319       1.312163       1.0   
         KBA05\_KRSHERST2              189369.0       3.077589       1.348418       1.0   
         KBA05\_KRSHERST3              189369.0       3.152638       1.365023       1.0   
         KBA05\_KRSKLEIN               189369.0       2.127418       1.163597       1.0   
         KBA05\_KRSOBER                189369.0       2.104384       1.149900       1.0   
         KBA05\_KRSVAN                 189369.0       2.137742       1.130825       1.0   
         KBA05\_KRSZUL                 189369.0       2.068121       1.199902       1.0   
         KBA05\_KW1                    189369.0       3.094186       1.381311       1.0   
         KBA05\_KW2                    189369.0       3.112294       1.337136       1.0   
         KBA05\_KW3                    189369.0       1.557715       1.611227       0.0   
         KBA05\_MAXAH                  189369.0       3.386082       1.497831       1.0   
         KBA05\_MAXBJ                  189369.0       2.444059       1.498428       1.0   
         KBA05\_MAXHERST               189369.0       2.866736       1.407009       1.0   
         KBA05\_MAXSEG                 189369.0       2.280109       1.321593       1.0   
         KBA05\_MAXVORB                189369.0       2.218283       1.213737       1.0   
         KBA05\_MOD1                   189369.0       1.442892       1.648886       0.0   
         KBA05\_MOD2                   189369.0       3.092755       1.332195       1.0   
         KBA05\_MOD3                   189369.0       3.096869       1.351790       1.0   
         KBA05\_MOD4                   189369.0       2.829808       1.615254       0.0   
         KBA05\_MOD8                   189369.0       1.383136       1.467841       0.0   
         KBA05\_MODTEMP                199536.0       3.010063       1.255505       1.0   
         KBA05\_MOTOR                  189369.0       2.652155       1.290141       1.0   
         KBA05\_MOTRAD                 189369.0       1.164251       1.361905       0.0   
         KBA05\_SEG1                   189369.0       1.235112       1.445409       0.0   
         KBA05\_SEG10                  189369.0       2.012758       1.512040       0.0   
         KBA05\_SEG2                   189369.0       3.095945       1.335347       1.0   
         KBA05\_SEG3                   189369.0       3.088673       1.345674       1.0   
         KBA05\_SEG4                   189369.0       3.101738       1.322352       1.0   
         KBA05\_SEG5                   189369.0       1.601160       1.570557       0.0   
         KBA05\_SEG6                   189369.0       0.293702       1.275152       0.0   
         KBA05\_SEG7                   189369.0       0.993114       1.483128       0.0   
         KBA05\_SEG8                   189369.0       0.906511       1.477588       0.0   
         KBA05\_SEG9                   189369.0       1.216567       1.449693       0.0   
         KBA05\_VORB0                  189369.0       2.973565       1.419375       1.0   
         KBA05\_VORB1                  189369.0       3.111365       1.335301       1.0   
         KBA05\_VORB2                  189369.0       2.859808       1.619548       0.0   
         KBA05\_ZUL1                   189369.0       3.103359       1.337501       1.0   
         KBA05\_ZUL2                   189369.0       3.105287       1.342012       1.0   
         KBA05\_ZUL3                   189369.0       2.781210       1.616524       0.0   
         KBA05\_ZUL4                   189369.0       2.273915       1.735527       0.0   
         KBA13\_ALTERHALTER\_30         196292.0       2.974456       1.060998       1.0   
         KBA13\_ALTERHALTER\_45         196292.0       3.084344       1.114021       1.0   
         KBA13\_ALTERHALTER\_60         196292.0       2.817726       1.053987       1.0   
         KBA13\_ALTERHALTER\_61         196292.0       3.123383       1.065016       1.0   
         KBA13\_ANTG1                  196292.0       2.149818       0.921785       0.0   
         KBA13\_ANTG2                  196292.0       2.779864       0.932846       0.0   
         KBA13\_ANTG3                  196292.0       1.606550       1.017913       0.0   
         KBA13\_ANTG4                  196292.0       0.677919       0.736662       0.0   
         KBA13\_ANZAHL\_PKW             196292.0     619.594140     340.017458       0.0   
         KBA13\_AUDI                   196292.0       3.004600       1.002544       1.0   
         KBA13\_AUTOQUOTE              196292.0       2.779222       1.049127       1.0   
         KBA13\_BAUMAX                 196292.0       2.022900       1.513146       1.0   
         KBA13\_BJ\_1999                196292.0       2.987738       0.962067       1.0   
         KBA13\_BJ\_2000                196292.0       2.991324       0.998346       1.0   
         KBA13\_BJ\_2004                196292.0       2.980060       0.949177       1.0   
         KBA13\_BJ\_2006                196292.0       2.981477       0.964027       1.0   
         KBA13\_BJ\_2008                196292.0       2.433502       1.466144       0.0   
         KBA13\_BJ\_2009                196292.0       2.454736       1.446477       0.0   
         KBA13\_BMW                    196292.0       3.161968       1.000276       1.0   
         KBA13\_CCM\_0\_1400             196292.0       2.343967       1.445986       0.0   
         KBA13\_CCM\_1000               196292.0       2.425866       1.438625       0.0   
         KBA13\_CCM\_1200               196292.0       2.331053       1.458918       0.0   
         KBA13\_CCM\_1400               196292.0       3.003398       0.942414       1.0   
         KBA13\_CCM\_1401\_2500          196292.0       2.905095       0.947165       1.0   
         KBA13\_CCM\_1500               196292.0       2.618910       1.420560       1.0   
         KBA13\_CCM\_1600               196292.0       3.027306       0.938858       1.0   
         KBA13\_CCM\_1800               196292.0       2.363000       1.432622       0.0   
         KBA13\_CCM\_2000               196292.0       3.070247       0.938225       1.0   
         KBA13\_CCM\_2500               196292.0       2.484783       1.415045       0.0   
         KBA13\_CCM\_2501               196292.0       2.518590       1.450508       0.0   
         KBA13\_CCM\_3000               196292.0       2.589036       1.369074       0.0   
         KBA13\_CCM\_3001               196292.0       2.631880       1.512100       1.0   
         KBA13\_FAB\_ASIEN              196292.0       2.970289       1.017689       1.0   
         KBA13\_FAB\_SONSTIGE           196292.0       2.987172       1.009246       1.0   
         KBA13\_FIAT                   196292.0       3.130586       1.000822       1.0   
         KBA13\_FORD                   196292.0       3.000688       1.040383       1.0   
         KBA13\_GBZ                    196292.0       3.419350       1.120275       1.0   
         KBA13\_HALTER\_20              196292.0       2.905488       1.000855       1.0   
         KBA13\_HALTER\_25              196292.0       2.939249       1.034662       1.0   
         KBA13\_HALTER\_30              196292.0       3.052758       1.088977       1.0   
         KBA13\_HALTER\_35              196292.0       3.102332       1.105938       1.0   
         KBA13\_HALTER\_40              196292.0       3.090707       1.095563       1.0   
         KBA13\_HALTER\_45              196292.0       3.030011       1.078618       1.0   
         KBA13\_HALTER\_50              196292.0       2.842184       1.051930       1.0   
         KBA13\_HALTER\_55              196292.0       2.838129       1.062823       1.0   
         KBA13\_HALTER\_60              196292.0       2.889690       1.072195       1.0   
         KBA13\_HALTER\_65              196292.0       3.133887       1.044194       1.0   
         KBA13\_HALTER\_66              196292.0       3.106041       1.075272       1.0   
         KBA13\_HERST\_ASIEN            196292.0       3.004040       1.028740       1.0   
         KBA13\_HERST\_AUDI\_VW          196292.0       2.926635       1.023956       1.0   
         KBA13\_HERST\_BMW\_BENZ         196292.0       3.167893       1.021113       1.0   
         KBA13\_HERST\_EUROPA           196292.0       3.085765       1.013089       1.0   
         KBA13\_HERST\_FORD\_OPEL        196292.0       2.964848       1.057225       1.0   
         KBA13\_HERST\_SONST            196292.0       2.987172       1.009246       1.0   
         KBA13\_HHZ                    196292.0       3.573920       0.977347       1.0   
         KBA13\_KMH\_0\_140              196292.0       2.332056       1.528376       0.0   
         KBA13\_KMH\_110                196292.0       1.319478       0.675329       1.0   
         KBA13\_KMH\_140                196292.0       2.695846       1.391154       1.0   
         KBA13\_KMH\_140\_210            196292.0       2.844818       0.971212       1.0   
         KBA13\_KMH\_180                196292.0       2.933711       0.971389       1.0   
         KBA13\_KMH\_210                196292.0       3.033384       0.955816       1.0   
         KBA13\_KMH\_211                196292.0       2.466152       1.491436       0.0   
         KBA13\_KMH\_250                196292.0       2.463111       1.490359       0.0   
         KBA13\_KMH\_251                196292.0       1.271809       0.675938       1.0   
         KBA13\_KRSAQUOT               196292.0       2.863841       1.063894       0.0   
         KBA13\_KRSHERST\_AUDI\_VW       196292.0       2.957492       1.009594       0.0   
         KBA13\_KRSHERST\_BMW\_BENZ      196292.0       3.084721       1.008412       0.0   
         KBA13\_KRSHERST\_FORD\_OPEL     196292.0       3.007142       1.041751       0.0   
         KBA13\_KRSSEG\_KLEIN           196292.0       1.994916       0.291706       0.0   
         KBA13\_KRSSEG\_OBER            196292.0       1.955841       0.584353       0.0   
         KBA13\_KRSSEG\_VAN             196292.0       1.946738       0.616398       0.0   
         KBA13\_KRSZUL\_NEU             196292.0       1.833518       0.782976       0.0   
         KBA13\_KW\_0\_60                196292.0       2.976474       0.968847       1.0   
         KBA13\_KW\_110                 196292.0       2.399675       1.430466       0.0   
         KBA13\_KW\_120                 196292.0       2.380143       1.504220       0.0   
         KBA13\_KW\_121                 196292.0       2.514183       1.439424       0.0   
         KBA13\_KW\_30                  196292.0       1.403959       0.680388       1.0   
         KBA13\_KW\_40                  196292.0       2.405248       1.413631       0.0   
         KBA13\_KW\_50                  196292.0       2.345343       1.441600       0.0   
         KBA13\_KW\_60                  196292.0       2.288942       1.409958       0.0   
         KBA13\_KW\_61\_120              196292.0       2.993342       0.956652       1.0   
         KBA13\_KW\_70                  196292.0       2.333075       1.431944       0.0   
         KBA13\_KW\_80                  196292.0       2.309738       1.407373       0.0   
         KBA13\_KW\_90                  196292.0       2.383337       1.432065       0.0   
         KBA13\_MAZDA                  196292.0       3.084919       1.000123       1.0   
         KBA13\_MERCEDES               196292.0       3.148391       1.022610       1.0   
         KBA13\_MOTOR                  196292.0       2.787373       0.767580       1.0   
         KBA13\_NISSAN                 196292.0       3.062453       1.016779       1.0   
         KBA13\_OPEL                   196292.0       2.972118       1.054313       1.0   
         KBA13\_PEUGEOT                196292.0       3.072061       1.007164       1.0   
         KBA13\_RENAULT                196292.0       3.043145       1.023581       1.0   
         KBA13\_SEG\_GELAENDEWAGEN      196292.0       2.911907       0.999846       1.0   
         KBA13\_SEG\_GROSSRAUMVANS      196292.0       3.080548       1.013653       1.0   
         KBA13\_SEG\_KLEINST            196292.0       2.990295       1.028201       1.0   
         KBA13\_SEG\_KLEINWAGEN         196292.0       2.944598       1.015503       1.0   
         KBA13\_SEG\_KOMPAKTKLASSE      196292.0       2.946676       1.017404       1.0   
         KBA13\_SEG\_MINIVANS           196292.0       3.021927       1.014221       1.0   
         KBA13\_SEG\_MINIWAGEN          196292.0       3.121727       1.011842       1.0   
         KBA13\_SEG\_MITTELKLASSE       196292.0       3.054638       1.025931       1.0   
         KBA13\_SEG\_OBEREMITTELKLASSE  196292.0       3.164092       1.007035       1.0   
         KBA13\_SEG\_OBERKLASSE         196292.0       2.501865       1.480930       0.0   
         KBA13\_SEG\_SONSTIGE           196292.0       3.070736       0.963647       1.0   
         KBA13\_SEG\_SPORTWAGEN         196292.0       2.571042       1.438781       0.0   
         KBA13\_SEG\_UTILITIES          196292.0       3.014947       0.997856       1.0   
         KBA13\_SEG\_VAN                196292.0       3.050715       1.012156       1.0   
         KBA13\_SEG\_WOHNMOBILE         196292.0       2.538371       1.412115       0.0   
         KBA13\_SITZE\_4                196292.0       3.177847       1.052724       1.0   
         KBA13\_SITZE\_5                196292.0       2.836443       1.053655       1.0   
         KBA13\_SITZE\_6                196292.0       3.073192       1.040840       1.0   
         KBA13\_TOYOTA                 196292.0       3.077135       1.007325       1.0   
         KBA13\_VORB\_0                 196292.0       3.119220       0.977095       1.0   
         KBA13\_VORB\_1                 196292.0       2.979938       0.956132       1.0   
         KBA13\_VORB\_1\_2               196292.0       2.914245       0.963019       1.0   
         KBA13\_VORB\_2                 196292.0       3.009690       0.944398       1.0   
         KBA13\_VORB\_3                 196292.0       2.356066       1.468452       0.0   
         KBA13\_VW                     196292.0       2.937170       1.026872       1.0   
         KK\_KUNDENTYP                  76552.0       3.405019       1.630733       1.0   
         KKK                          192372.0       2.592425       1.116042       0.0   
         KOMBIALTER                   222804.0       3.518815       2.111566       1.0   
         KONSUMNAEHE                  204348.0       3.014847       1.552242       1.0   
         KONSUMZELLE                  199534.0       0.237363       0.425468       0.0   
         LP\_FAMILIE\_FEIN              221570.0       3.586803       3.918408       0.0   
         LP\_FAMILIE\_GROB              221570.0       2.180570       1.753665       0.0   
         LP\_LEBENSPHASE\_FEIN          221570.0      14.585093      12.592262       0.0   
         LP\_LEBENSPHASE\_GROB          221570.0       4.441567       3.847331       0.0   
         LP\_STATUS\_FEIN               221570.0       4.780787       3.419909       1.0   
         LP\_STATUS\_GROB               221570.0       2.428127       1.471889       1.0   
         MIN\_GEBAEUDEJAHR             199536.0    1993.286490       3.360120    1985.0   
         MOBI\_RASTER                  199536.0       2.375947       1.536710       1.0   
         MOBI\_REGIO                   189369.0       2.960416       1.430452       1.0   
         NATIONALITAET\_KZ             222804.0       1.027046       0.587199       0.0   
         ONLINE\_AFFINITAET            221570.0       2.696128       1.519796       0.0   
         ORTSGR\_KLS9                  198530.0       5.299018       2.305978       0.0   
         PLZ8\_ANTG1                   193557.0       2.252530       0.972008       0.0   
         PLZ8\_ANTG2                   193557.0       2.803856       0.919755       0.0   
         PLZ8\_ANTG3                   193557.0       1.597369       0.987366       0.0   
         PLZ8\_ANTG4                   193557.0       0.701380       0.727795       0.0   
         PLZ8\_BAUMAX                  193557.0       1.948243       1.463159       1.0   
         PLZ8\_GBZ                     193557.0       3.380028       1.112141       1.0   
         PLZ8\_HHZ                     193557.0       3.613210       0.973386       1.0   
         PRAEGENDE\_JUGENDJAHRE        222804.0       8.147031       4.848497       0.0   
         REGIOTYP                     192372.0       4.264602       2.028204       0.0   
         RELAT\_AB                     198530.0       3.069571       1.360326       1.0   
         RETOURTYP\_BK\_S               221570.0       3.424110       1.416724       1.0   
         RT\_KEIN\_ANREIZ               221570.0       3.233917       1.390483       1.0   
         RT\_SCHNAEPPCHEN              221570.0       3.863524       1.281873       1.0   
         RT\_UEBERGROESSE              210019.0       3.024974       1.502125       0.0   
         SEMIO\_DOM                    222804.0       4.672573       1.793350       1.0   
         SEMIO\_ERL                    222804.0       4.485319       1.809355       1.0   
         SEMIO\_FAM                    222804.0       4.268317       1.916327       1.0   
         SEMIO\_KAEM                   222804.0       4.450100       1.850688       1.0   
         SEMIO\_KRIT                   222804.0       4.768931       1.828893       1.0   
         SEMIO\_KULT                   222804.0       4.018738       1.905736       1.0   
         SEMIO\_LUST                   222804.0       4.358257       2.026337       1.0   
         SEMIO\_MAT                    222804.0       3.997325       1.856584       1.0   
         SEMIO\_PFLICHT                222804.0       4.258667       1.769329       1.0   
         SEMIO\_RAT                    222804.0       3.912282       1.578690       1.0   
         SEMIO\_REL                    222804.0       4.238519       2.007472       1.0   
         SEMIO\_SOZ                    222804.0       3.941877       1.947373       1.0   
         SEMIO\_TRADV                  222804.0       3.659674       1.708609       1.0   
         SEMIO\_VERT                   222804.0       4.019048       2.076709       1.0   
         SHOPPER\_TYP                  222804.0       1.267863       1.287078      -1.0   
         SOHO\_KZ                      204478.0       0.008593       0.092297       0.0   
         STRUKTURTYP                  198520.0       2.539855       0.754686       1.0   
         TITEL\_KZ                     204478.0       0.003257       0.083856       0.0   
         UMFELD\_ALT                   198334.0       3.221954       1.255440       1.0   
         UMFELD\_JUNG                  198334.0       4.017355       1.117651       1.0   
         UNGLEICHENN\_FLAG             204478.0       0.090034       0.286231       0.0   
         VERDICHTUNGSRAUM             198520.0       4.578587       8.455321       0.0   
         VERS\_TYP                     222804.0       1.198726       0.952954      -1.0   
         VHA                          204478.0       0.435568       1.137983       0.0   
         VHN                          192372.0       2.422432       1.165787       0.0   
         VK\_DHT4A                     203846.0       6.010591       2.853237       1.0   
         VK\_DISTANZ                   203846.0       7.539633       3.243118       1.0   
         VK\_ZG11                      203846.0       5.946636       2.771014       1.0   
         W\_KEIT\_KIND\_HH               195820.0       3.939128       1.962986       0.0   
         WOHNDAUER\_2008               204478.0       7.907301       1.924986       1.0   
         WOHNLAGE                     199536.0       4.050698       1.947708       0.0   
         ZABEOTYP                     222804.0       3.365967       1.352564       1.0   
         ANREDE\_KZ                    222804.0       1.524070       0.499421       1.0   
         ALTERSKATEGORIE\_GROB         222804.0       2.777603       1.069265       1.0   
         
                                           25\%       50\%        75\%        max  
         LNR                          415521.0  637463.0  860476.75  1082871.0  
         AGER\_TYP                         -1.0      -1.0      -1.00        3.0  
         AKT\_DAT\_KL                        1.0       3.0       9.00        9.0  
         ALTER\_HH                          0.0      13.0      17.00       21.0  
         ALTER\_KIND1                       8.0      12.0      15.00       18.0  
         ALTER\_KIND2                      11.0      14.0      16.00       18.0  
         ALTER\_KIND3                      13.0      15.0      17.00       18.0  
         ALTER\_KIND4                      13.0      15.0      17.00       18.0  
         ALTERSKATEGORIE\_FEIN             11.0      14.0      17.00       25.0  
         ANZ\_HAUSHALTE\_AKTIV               1.0       4.0      10.00      595.0  
         ANZ\_HH\_TITEL                      0.0       0.0       0.00       23.0  
         ANZ\_KINDER                        0.0       0.0       0.00        9.0  
         ANZ\_PERSONEN                      1.0       1.0       2.00       40.0  
         ANZ\_STATISTISCHE\_HAUSHALTE        1.0       3.0       9.00      449.0  
         ANZ\_TITEL                         0.0       0.0       0.00        3.0  
         ARBEIT                            3.0       3.0       4.00        9.0  
         BALLRAUM                          2.0       5.0       6.00        7.0  
         CAMEO\_DEUG\_2015                   3.0       6.0       8.00        9.0  
         CAMEO\_INTL\_2015                  24.0      41.0      51.00       55.0  
         CJT\_GESAMTTYP                     2.0       4.0       5.00        6.0  
         CJT\_KATALOGNUTZER                 2.0       4.0       5.00        5.0  
         CJT\_TYP\_1                         2.0       3.0       5.00        5.0  
         CJT\_TYP\_2                         2.0       3.0       5.00        5.0  
         CJT\_TYP\_3                         2.0       3.0       5.00        5.0  
         CJT\_TYP\_4                         2.0       3.0       5.00        5.0  
         CJT\_TYP\_5                         2.0       3.0       5.00        5.0  
         CJT\_TYP\_6                         2.0       4.0       5.00        5.0  
         D19\_BANKEN\_ANZ\_12                 0.0       0.0       0.00        6.0  
         D19\_BANKEN\_ANZ\_24                 0.0       0.0       0.00        6.0  
         D19\_BANKEN\_DATUM                 10.0      10.0      10.00       10.0  
         D19\_BANKEN\_DIREKT                 0.0       0.0       0.00        7.0  
         D19\_BANKEN\_GROSS                  0.0       0.0       0.00        6.0  
         D19\_BANKEN\_LOKAL                  0.0       0.0       0.00        7.0  
         D19\_BANKEN\_OFFLINE\_DATUM         10.0      10.0      10.00       10.0  
         D19\_BANKEN\_ONLINE\_DATUM          10.0      10.0      10.00       10.0  
         D19\_BANKEN\_ONLINE\_QUOTE\_12        0.0       0.0       0.00       10.0  
         D19\_BANKEN\_REST                   0.0       0.0       0.00        7.0  
         D19\_BEKLEIDUNG\_GEH                0.0       0.0       0.00        7.0  
         D19\_BEKLEIDUNG\_REST               0.0       0.0       0.00        7.0  
         D19\_BILDUNG                       0.0       0.0       0.00        7.0  
         D19\_BIO\_OEKO                      0.0       0.0       0.00        7.0  
         D19\_BUCH\_CD                       0.0       0.0       3.00        7.0  
         D19\_DIGIT\_SERV                    0.0       0.0       0.00        7.0  
         D19\_DROGERIEARTIKEL               0.0       0.0       0.00        7.0  
         D19\_ENERGIE                       0.0       0.0       0.00        7.0  
         D19\_FREIZEIT                      0.0       0.0       0.00        7.0  
         D19\_GARTEN                        0.0       0.0       0.00        7.0  
         D19\_GESAMT\_ANZ\_12                 0.0       0.0       1.00        6.0  
         D19\_GESAMT\_ANZ\_24                 0.0       0.0       2.00        6.0  
         D19\_GESAMT\_DATUM                  5.0       9.0      10.00       10.0  
         D19\_GESAMT\_OFFLINE\_DATUM          9.0      10.0      10.00       10.0  
         D19\_GESAMT\_ONLINE\_DATUM           5.0      10.0      10.00       10.0  
         D19\_GESAMT\_ONLINE\_QUOTE\_12        0.0       0.0      10.00       10.0  
         D19\_HANDWERK                      0.0       0.0       0.00        7.0  
         D19\_HAUS\_DEKO                     0.0       0.0       0.00        7.0  
         D19\_KINDERARTIKEL                 0.0       0.0       0.00        7.0  
         D19\_KONSUMTYP                     2.0       5.0       9.00        9.0  
         D19\_KONSUMTYP\_MAX                 2.0       8.0       9.00        9.0  
         D19\_KOSMETIK                      0.0       0.0       0.00        7.0  
         D19\_LEBENSMITTEL                  0.0       0.0       0.00        7.0  
         D19\_LOTTO                         0.0       0.0       0.00        7.0  
         D19\_NAHRUNGSERGAENZUNG            0.0       0.0       0.00        7.0  
         D19\_RATGEBER                      0.0       0.0       0.00        7.0  
         D19\_REISEN                        0.0       0.0       0.00        7.0  
         D19\_SAMMELARTIKEL                 0.0       0.0       0.00        7.0  
         D19\_SCHUHE                        0.0       0.0       0.00        7.0  
         D19\_SONSTIGE                      0.0       0.0       6.00        7.0  
         D19\_SOZIALES                      0.0       0.0       0.00        5.0  
         D19\_TECHNIK                       0.0       0.0       6.00        7.0  
         D19\_TELKO\_ANZ\_12                  0.0       0.0       0.00        6.0  
         D19\_TELKO\_ANZ\_24                  0.0       0.0       0.00        6.0  
         D19\_TELKO\_DATUM                   9.0      10.0      10.00       10.0  
         D19\_TELKO\_MOBILE                  0.0       0.0       0.00        7.0  
         D19\_TELKO\_OFFLINE\_DATUM          10.0      10.0      10.00       10.0  
         D19\_TELKO\_ONLINE\_DATUM           10.0      10.0      10.00       10.0  
         D19\_TELKO\_ONLINE\_QUOTE\_12         0.0       0.0       0.00       10.0  
         D19\_TELKO\_REST                    0.0       0.0       0.00        7.0  
         D19\_TIERARTIKEL                   0.0       0.0       0.00        7.0  
         D19\_VERSAND\_ANZ\_12                0.0       0.0       1.00        6.0  
         D19\_VERSAND\_ANZ\_24                0.0       0.0       2.00        6.0  
         D19\_VERSAND\_DATUM                 5.0       9.0      10.00       10.0  
         D19\_VERSAND\_OFFLINE\_DATUM         9.0      10.0      10.00       10.0  
         D19\_VERSAND\_ONLINE\_DATUM          6.0      10.0      10.00       10.0  
         D19\_VERSAND\_ONLINE\_QUOTE\_12       0.0       0.0      10.00       10.0  
         D19\_VERSAND\_REST                  0.0       0.0       0.00        7.0  
         D19\_VERSI\_ANZ\_12                  0.0       0.0       0.00        6.0  
         D19\_VERSI\_ANZ\_24                  0.0       0.0       0.00        6.0  
         D19\_VERSI\_DATUM                   9.0      10.0      10.00       10.0  
         D19\_VERSI\_OFFLINE\_DATUM          10.0      10.0      10.00       10.0  
         D19\_VERSI\_ONLINE\_DATUM           10.0      10.0      10.00       10.0  
         D19\_VERSI\_ONLINE\_QUOTE\_12         0.0       0.0       0.00       10.0  
         D19\_VERSICHERUNGEN                0.0       0.0       2.00        7.0  
         D19\_VOLLSORTIMENT                 0.0       0.0       5.00        7.0  
         D19\_WEIN\_FEINKOST                 0.0       0.0       0.00        7.0  
         DSL\_FLAG                          1.0       1.0       1.00        1.0  
         EINGEZOGENAM\_HH\_JAHR           1997.0    2003.0    2010.00     2018.0  
         EWDICHTE                          2.0       4.0       6.00        6.0  
         EXTSEL992                        23.0      34.0      43.00       56.0  
         FINANZ\_ANLEGER                    2.0       3.0       5.00        5.0  
         FINANZ\_HAUSBAUER                  2.0       3.0       4.00        5.0  
         FINANZ\_MINIMALIST                 2.0       3.0       4.00        5.0  
         FINANZ\_SPARER                     1.0       3.0       4.00        5.0  
         FINANZ\_UNAUFFAELLIGER             2.0       3.0       4.00        5.0  
         FINANZ\_VORSORGER                  3.0       3.0       5.00        5.0  
         FINANZTYP                         2.0       4.0       6.00        6.0  
         FIRMENDICHTE                      3.0       4.0       4.00        5.0  
         GEBAEUDETYP                       1.0       1.0       3.00        8.0  
         GEBAEUDETYP\_RASTER                3.0       4.0       4.00        5.0  
         GEBURTSJAHR                       0.0    1943.0    1970.00     2017.0  
         GEMEINDETYP                      12.0      22.0      30.00       50.0  
         GFK\_URLAUBERTYP                   5.0       8.0      10.00       12.0  
         GREEN\_AVANTGARDE                  0.0       0.0       0.00        1.0  
         HEALTH\_TYP                        1.0       2.0       3.00        3.0  
         HH\_DELTA\_FLAG                     0.0       0.0       0.00        1.0  
         HH\_EINKOMMEN\_SCORE                3.0       5.0       6.00        6.0  
         INNENSTADT                        3.0       5.0       6.00        8.0  
         KBA05\_ALTER1                      1.0       2.0       3.00        9.0  
         KBA05\_ALTER2                      2.0       3.0       4.00        9.0  
         KBA05\_ALTER3                      2.0       3.0       4.00        9.0  
         KBA05\_ALTER4                      2.0       3.0       4.00        9.0  
         KBA05\_ANHANG                      0.0       1.0       1.00        9.0  
         KBA05\_ANTG1                       0.0       1.0       3.00        4.0  
         KBA05\_ANTG2                       0.0       1.0       2.00        4.0  
         KBA05\_ANTG3                       0.0       0.0       1.00        3.0  
         KBA05\_ANTG4                       0.0       0.0       0.00        2.0  
         KBA05\_AUTOQUOT                    2.0       3.0       4.00        9.0  
         KBA05\_BAUMAX                      0.0       1.0       3.00        5.0  
         KBA05\_CCM1                        2.0       3.0       4.00        9.0  
         KBA05\_CCM2                        2.0       3.0       4.00        9.0  
         KBA05\_CCM3                        2.0       3.0       4.00        9.0  
         KBA05\_CCM4                        0.0       1.0       2.00        9.0  
         KBA05\_DIESEL                      1.0       2.0       3.00        9.0  
         KBA05\_FRAU                        2.0       3.0       4.00        9.0  
         KBA05\_GBZ                         2.0       3.0       4.00        5.0  
         KBA05\_HERST1                      1.0       2.0       3.00        9.0  
         KBA05\_HERST2                      2.0       3.0       4.00        9.0  
         KBA05\_HERST3                      2.0       3.0       4.00        9.0  
         KBA05\_HERST4                      2.0       3.0       4.00        9.0  
         KBA05\_HERST5                      2.0       3.0       4.00        9.0  
         KBA05\_HERSTTEMP                   2.0       3.0       4.00        9.0  
         KBA05\_KRSAQUOT                    2.0       3.0       4.00        9.0  
         KBA05\_KRSHERST1                   2.0       3.0       4.00        9.0  
         KBA05\_KRSHERST2                   2.0       3.0       4.00        9.0  
         KBA05\_KRSHERST3                   2.0       3.0       4.00        9.0  
         KBA05\_KRSKLEIN                    2.0       2.0       2.00        9.0  
         KBA05\_KRSOBER                     2.0       2.0       2.00        9.0  
         KBA05\_KRSVAN                      2.0       2.0       2.00        9.0  
         KBA05\_KRSZUL                      1.0       2.0       2.00        9.0  
         KBA05\_KW1                         2.0       3.0       4.00        9.0  
         KBA05\_KW2                         2.0       3.0       4.00        9.0  
         KBA05\_KW3                         0.0       1.0       2.00        9.0  
         KBA05\_MAXAH                       2.0       3.0       5.00        9.0  
         KBA05\_MAXBJ                       1.0       2.0       4.00        9.0  
         KBA05\_MAXHERST                    2.0       3.0       4.00        9.0  
         KBA05\_MAXSEG                      1.0       2.0       3.00        9.0  
         KBA05\_MAXVORB                     2.0       2.0       3.00        9.0  
         KBA05\_MOD1                        0.0       1.0       2.00        9.0  
         KBA05\_MOD2                        2.0       3.0       4.00        9.0  
         KBA05\_MOD3                        2.0       3.0       4.00        9.0  
         KBA05\_MOD4                        2.0       3.0       4.00        9.0  
         KBA05\_MOD8                        0.0       1.0       2.00        9.0  
         KBA05\_MODTEMP                     2.0       3.0       4.00        6.0  
         KBA05\_MOTOR                       2.0       3.0       3.00        9.0  
         KBA05\_MOTRAD                      0.0       1.0       1.00        9.0  
         KBA05\_SEG1                        0.0       1.0       2.00        9.0  
         KBA05\_SEG10                       1.0       2.0       3.00        9.0  
         KBA05\_SEG2                        2.0       3.0       4.00        9.0  
         KBA05\_SEG3                        2.0       3.0       4.00        9.0  
         KBA05\_SEG4                        2.0       3.0       4.00        9.0  
         KBA05\_SEG5                        1.0       1.0       2.00        9.0  
         KBA05\_SEG6                        0.0       0.0       0.00        9.0  
         KBA05\_SEG7                        0.0       1.0       2.00        9.0  
         KBA05\_SEG8                        0.0       0.0       1.00        9.0  
         KBA05\_SEG9                        0.0       1.0       2.00        9.0  
         KBA05\_VORB0                       2.0       3.0       4.00        9.0  
         KBA05\_VORB1                       2.0       3.0       4.00        9.0  
         KBA05\_VORB2                       2.0       3.0       4.00        9.0  
         KBA05\_ZUL1                        2.0       3.0       4.00        9.0  
         KBA05\_ZUL2                        2.0       3.0       4.00        9.0  
         KBA05\_ZUL3                        2.0       3.0       4.00        9.0  
         KBA05\_ZUL4                        1.0       2.0       3.00        9.0  
         KBA13\_ALTERHALTER\_30              2.0       3.0       4.00        5.0  
         KBA13\_ALTERHALTER\_45              2.0       3.0       4.00        5.0  
         KBA13\_ALTERHALTER\_60              2.0       3.0       3.00        5.0  
         KBA13\_ALTERHALTER\_61              2.0       3.0       4.00        5.0  
         KBA13\_ANTG1                       1.0       2.0       3.00        4.0  
         KBA13\_ANTG2                       2.0       3.0       3.00        4.0  
         KBA13\_ANTG3                       1.0       2.0       2.00        3.0  
         KBA13\_ANTG4                       0.0       1.0       1.00        2.0  
         KBA13\_ANZAHL\_PKW                383.0     549.0     777.00     2300.0  
         KBA13\_AUDI                        2.0       3.0       4.00        5.0  
         KBA13\_AUTOQUOTE                   2.0       3.0       3.00        5.0  
         KBA13\_BAUMAX                      1.0       1.0       3.00        5.0  
         KBA13\_BJ\_1999                     2.0       3.0       4.00        5.0  
         KBA13\_BJ\_2000                     2.0       3.0       4.00        5.0  
         KBA13\_BJ\_2004                     2.0       3.0       4.00        5.0  
         KBA13\_BJ\_2006                     2.0       3.0       4.00        5.0  
         KBA13\_BJ\_2008                     2.0       3.0       3.00        5.0  
         KBA13\_BJ\_2009                     1.0       3.0       3.00        5.0  
         KBA13\_BMW                         3.0       3.0       4.00        5.0  
         KBA13\_CCM\_0\_1400                  1.0       3.0       3.00        5.0  
         KBA13\_CCM\_1000                    1.0       3.0       3.00        5.0  
         KBA13\_CCM\_1200                    1.0       3.0       3.00        5.0  
         KBA13\_CCM\_1400                    2.0       3.0       4.00        5.0  
         KBA13\_CCM\_1401\_2500               2.0       3.0       3.00        5.0  
         KBA13\_CCM\_1500                    1.0       3.0       4.00        5.0  
         KBA13\_CCM\_1600                    2.0       3.0       4.00        5.0  
         KBA13\_CCM\_1800                    2.0       3.0       3.00        5.0  
         KBA13\_CCM\_2000                    3.0       3.0       4.00        5.0  
         KBA13\_CCM\_2500                    1.0       3.0       3.00        5.0  
         KBA13\_CCM\_2501                    1.0       3.0       3.00        5.0  
         KBA13\_CCM\_3000                    1.0       3.0       3.00        5.0  
         KBA13\_CCM\_3001                    1.0       3.0       4.00        5.0  
         KBA13\_FAB\_ASIEN                   2.0       3.0       4.00        5.0  
         KBA13\_FAB\_SONSTIGE                2.0       3.0       4.00        5.0  
         KBA13\_FIAT                        3.0       3.0       4.00        5.0  
         KBA13\_FORD                        2.0       3.0       4.00        5.0  
         KBA13\_GBZ                         3.0       3.0       4.00        5.0  
         KBA13\_HALTER\_20                   2.0       3.0       3.00        5.0  
         KBA13\_HALTER\_25                   2.0       3.0       4.00        5.0  
         KBA13\_HALTER\_30                   2.0       3.0       4.00        5.0  
         KBA13\_HALTER\_35                   2.0       3.0       4.00        5.0  
         KBA13\_HALTER\_40                   2.0       3.0       4.00        5.0  
         KBA13\_HALTER\_45                   2.0       3.0       4.00        5.0  
         KBA13\_HALTER\_50                   2.0       3.0       3.00        5.0  
         KBA13\_HALTER\_55                   2.0       3.0       3.00        5.0  
         KBA13\_HALTER\_60                   2.0       3.0       4.00        5.0  
         KBA13\_HALTER\_65                   3.0       3.0       4.00        5.0  
         KBA13\_HALTER\_66                   2.0       3.0       4.00        5.0  
         KBA13\_HERST\_ASIEN                 2.0       3.0       4.00        5.0  
         KBA13\_HERST\_AUDI\_VW               2.0       3.0       4.00        5.0  
         KBA13\_HERST\_BMW\_BENZ              3.0       3.0       4.00        5.0  
         KBA13\_HERST\_EUROPA                2.0       3.0       4.00        5.0  
         KBA13\_HERST\_FORD\_OPEL             2.0       3.0       4.00        5.0  
         KBA13\_HERST\_SONST                 2.0       3.0       4.00        5.0  
         KBA13\_HHZ                         3.0       3.0       4.00        5.0  
         KBA13\_KMH\_0\_140                   1.0       3.0       3.00        5.0  
         KBA13\_KMH\_110                     1.0       1.0       1.00        3.0  
         KBA13\_KMH\_140                     1.0       3.0       4.00        5.0  
         KBA13\_KMH\_140\_210                 2.0       3.0       3.00        5.0  
         KBA13\_KMH\_180                     2.0       3.0       4.00        5.0  
         KBA13\_KMH\_210                     2.0       3.0       4.00        5.0  
         KBA13\_KMH\_211                     2.0       3.0       3.00        5.0  
         KBA13\_KMH\_250                     2.0       3.0       3.00        5.0  
         KBA13\_KMH\_251                     1.0       1.0       1.00        3.0  
         KBA13\_KRSAQUOT                    2.0       3.0       4.00        5.0  
         KBA13\_KRSHERST\_AUDI\_VW            2.0       3.0       4.00        5.0  
         KBA13\_KRSHERST\_BMW\_BENZ           2.0       3.0       4.00        5.0  
         KBA13\_KRSHERST\_FORD\_OPEL          2.0       3.0       4.00        5.0  
         KBA13\_KRSSEG\_KLEIN                2.0       2.0       2.00        3.0  
         KBA13\_KRSSEG\_OBER                 2.0       2.0       2.00        3.0  
         KBA13\_KRSSEG\_VAN                  2.0       2.0       2.00        3.0  
         KBA13\_KRSZUL\_NEU                  1.0       2.0       2.00        3.0  
         KBA13\_KW\_0\_60                     2.0       3.0       4.00        5.0  
         KBA13\_KW\_110                      2.0       3.0       3.00        5.0  
         KBA13\_KW\_120                      1.0       3.0       3.00        5.0  
         KBA13\_KW\_121                      1.0       3.0       3.00        5.0  
         KBA13\_KW\_30                       1.0       1.0       2.00        3.0  
         KBA13\_KW\_40                       1.0       3.0       3.00        5.0  
         KBA13\_KW\_50                       2.0       3.0       3.00        5.0  
         KBA13\_KW\_60                       1.0       3.0       3.00        5.0  
         KBA13\_KW\_61\_120                   2.0       3.0       4.00        5.0  
         KBA13\_KW\_70                       2.0       3.0       3.00        5.0  
         KBA13\_KW\_80                       1.0       3.0       3.00        5.0  
         KBA13\_KW\_90                       2.0       3.0       3.00        5.0  
         KBA13\_MAZDA                       2.0       3.0       4.00        5.0  
         KBA13\_MERCEDES                    3.0       3.0       4.00        5.0  
         KBA13\_MOTOR                       2.0       3.0       3.00        4.0  
         KBA13\_NISSAN                      2.0       3.0       4.00        5.0  
         KBA13\_OPEL                        2.0       3.0       4.00        5.0  
         KBA13\_PEUGEOT                     2.0       3.0       4.00        5.0  
         KBA13\_RENAULT                     2.0       3.0       4.00        5.0  
         KBA13\_SEG\_GELAENDEWAGEN           2.0       3.0       3.00        5.0  
         KBA13\_SEG\_GROSSRAUMVANS           2.0       3.0       4.00        5.0  
         KBA13\_SEG\_KLEINST                 2.0       3.0       4.00        5.0  
         KBA13\_SEG\_KLEINWAGEN              2.0       3.0       4.00        5.0  
         KBA13\_SEG\_KOMPAKTKLASSE           2.0       3.0       4.00        5.0  
         KBA13\_SEG\_MINIVANS                2.0       3.0       4.00        5.0  
         KBA13\_SEG\_MINIWAGEN               3.0       3.0       4.00        5.0  
         KBA13\_SEG\_MITTELKLASSE            2.0       3.0       4.00        5.0  
         KBA13\_SEG\_OBEREMITTELKLASSE       3.0       3.0       4.00        5.0  
         KBA13\_SEG\_OBERKLASSE              1.0       3.0       3.00        5.0  
         KBA13\_SEG\_SONSTIGE                2.0       3.0       4.00        5.0  
         KBA13\_SEG\_SPORTWAGEN              2.0       3.0       3.00        5.0  
         KBA13\_SEG\_UTILITIES               2.0       3.0       4.00        5.0  
         KBA13\_SEG\_VAN                     2.0       3.0       4.00        5.0  
         KBA13\_SEG\_WOHNMOBILE              2.0       3.0       3.00        5.0  
         KBA13\_SITZE\_4                     3.0       3.0       4.00        5.0  
         KBA13\_SITZE\_5                     2.0       3.0       3.00        5.0  
         KBA13\_SITZE\_6                     2.0       3.0       4.00        5.0  
         KBA13\_TOYOTA                      2.0       3.0       4.00        5.0  
         KBA13\_VORB\_0                      3.0       3.0       4.00        5.0  
         KBA13\_VORB\_1                      2.0       3.0       4.00        5.0  
         KBA13\_VORB\_1\_2                    2.0       3.0       3.00        5.0  
         KBA13\_VORB\_2                      2.0       3.0       4.00        5.0  
         KBA13\_VORB\_3                      1.0       3.0       3.00        5.0  
         KBA13\_VW                          2.0       3.0       4.00        5.0  
         KK\_KUNDENTYP                      2.0       3.0       5.00        6.0  
         KKK                               2.0       3.0       3.00        4.0  
         KOMBIALTER                        2.0       3.0       4.00        9.0  
         KONSUMNAEHE                       2.0       3.0       4.00        7.0  
         KONSUMZELLE                       0.0       0.0       0.00        1.0  
         LP\_FAMILIE\_FEIN                   1.0       1.0       8.00       11.0  
         LP\_FAMILIE\_GROB                   1.0       1.0       4.00        5.0  
         LP\_LEBENSPHASE\_FEIN               4.0      11.0      27.00       40.0  
         LP\_LEBENSPHASE\_GROB               1.0       3.0       8.00       12.0  
         LP\_STATUS\_FEIN                    2.0       4.0       9.00       10.0  
         LP\_STATUS\_GROB                    1.0       2.0       4.00        5.0  
         MIN\_GEBAEUDEJAHR               1992.0    1992.0    1993.00     2016.0  
         MOBI\_RASTER                       1.0       2.0       4.00        6.0  
         MOBI\_REGIO                        2.0       3.0       4.00        6.0  
         NATIONALITAET\_KZ                  1.0       1.0       1.00        3.0  
         ONLINE\_AFFINITAET                 1.0       3.0       4.00        5.0  
         ORTSGR\_KLS9                       4.0       5.0       7.00        9.0  
         PLZ8\_ANTG1                        1.0       2.0       3.00        4.0  
         PLZ8\_ANTG2                        2.0       3.0       3.00        4.0  
         PLZ8\_ANTG3                        1.0       2.0       2.00        3.0  
         PLZ8\_ANTG4                        0.0       1.0       1.00        2.0  
         PLZ8\_BAUMAX                       1.0       1.0       3.00        5.0  
         PLZ8\_GBZ                          3.0       3.0       4.00        5.0  
         PLZ8\_HHZ                          3.0       4.0       4.00        5.0  
         PRAEGENDE\_JUGENDJAHRE             5.0       8.0      14.00       15.0  
         REGIOTYP                          3.0       5.0       6.00        7.0  
         RELAT\_AB                          2.0       3.0       4.00        9.0  
         RETOURTYP\_BK\_S                    2.0       3.0       5.00        5.0  
         RT\_KEIN\_ANREIZ                    2.0       3.0       4.00        5.0  
         RT\_SCHNAEPPCHEN                   3.0       4.0       5.00        5.0  
         RT\_UEBERGROESSE                   2.0       3.0       4.00        5.0  
         SEMIO\_DOM                         3.0       5.0       6.00        7.0  
         SEMIO\_ERL                         3.0       4.0       6.00        7.0  
         SEMIO\_FAM                         3.0       4.0       6.00        7.0  
         SEMIO\_KAEM                        3.0       5.0       6.00        7.0  
         SEMIO\_KRIT                        3.0       5.0       6.00        7.0  
         SEMIO\_KULT                        3.0       4.0       5.00        7.0  
         SEMIO\_LUST                        2.0       5.0       6.00        7.0  
         SEMIO\_MAT                         2.0       4.0       5.00        7.0  
         SEMIO\_PFLICHT                     3.0       4.0       6.00        7.0  
         SEMIO\_RAT                         3.0       4.0       5.00        7.0  
         SEMIO\_REL                         3.0       4.0       6.00        7.0  
         SEMIO\_SOZ                         2.0       4.0       6.00        7.0  
         SEMIO\_TRADV                       2.0       3.0       5.00        7.0  
         SEMIO\_VERT                        2.0       4.0       6.00        7.0  
         SHOPPER\_TYP                       0.0       1.0       2.00        3.0  
         SOHO\_KZ                           0.0       0.0       0.00        1.0  
         STRUKTURTYP                       2.0       3.0       3.00        3.0  
         TITEL\_KZ                          0.0       0.0       0.00        5.0  
         UMFELD\_ALT                        2.0       3.0       4.00        5.0  
         UMFELD\_JUNG                       3.0       4.0       5.00        5.0  
         UNGLEICHENN\_FLAG                  0.0       0.0       0.00        1.0  
         VERDICHTUNGSRAUM                  0.0       1.0       5.00       45.0  
         VERS\_TYP                          1.0       1.0       2.00        2.0  
         VHA                               0.0       0.0       0.00        5.0  
         VHN                               2.0       2.0       3.00        4.0  
         VK\_DHT4A                          3.0       6.0       9.00       11.0  
         VK\_DISTANZ                        6.0       8.0      10.00       13.0  
         VK\_ZG11                           4.0       6.0       8.00       11.0  
         W\_KEIT\_KIND\_HH                    2.0       4.0       6.00        6.0  
         WOHNDAUER\_2008                    8.0       9.0       9.00        9.0  
         WOHNLAGE                          3.0       3.0       5.00        8.0  
         ZABEOTYP                          3.0       3.0       4.00        6.0  
         ANREDE\_KZ                         1.0       2.0       2.00        2.0  
         ALTERSKATEGORIE\_GROB              2.0       3.0       4.00        9.0  
\end{Verbatim}
            
    \subparagraph{Getting some basic stats related to customers dataset -
like shape, mean, standard deviation, different
percentiles}\label{getting-some-basic-stats-related-to-customers-dataset---like-shape-mean-standard-deviation-different-percentiles}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}12}]:} \PY{n}{customers}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}12}]:} (191652, 369)
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}13}]:} \PY{n}{customers}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}13}]:}       LNR  AGER\_TYP  AKT\_DAT\_KL  ALTER\_HH  ALTER\_KIND1  ALTER\_KIND2  \textbackslash{}
         0    9626         2         1.0      10.0          NaN          NaN   
         1    9628        -1         9.0      11.0          NaN          NaN   
         2  143872        -1         1.0       6.0          NaN          NaN   
         3  143873         1         1.0       8.0          NaN          NaN   
         4  143874        -1         1.0      20.0          NaN          NaN   
         
            ALTER\_KIND3  ALTER\_KIND4  ALTERSKATEGORIE\_FEIN  ANZ\_HAUSHALTE\_AKTIV  \textbackslash{}
         0          NaN          NaN                  10.0                  1.0   
         1          NaN          NaN                   NaN                  NaN   
         2          NaN          NaN                   0.0                  1.0   
         3          NaN          NaN                   8.0                  0.0   
         4          NaN          NaN                  14.0                  7.0   
         
                    {\ldots}           VK\_ZG11  W\_KEIT\_KIND\_HH  WOHNDAUER\_2008  WOHNLAGE  \textbackslash{}
         0          {\ldots}               2.0             6.0             9.0       7.0   
         1          {\ldots}               3.0             0.0             9.0       NaN   
         2          {\ldots}              11.0             6.0             9.0       2.0   
         3          {\ldots}               2.0             NaN             9.0       7.0   
         4          {\ldots}               4.0             2.0             9.0       3.0   
         
            ZABEOTYP      PRODUCT\_GROUP  CUSTOMER\_GROUP ONLINE\_PURCHASE  ANREDE\_KZ  \textbackslash{}
         0         3  COSMETIC\_AND\_FOOD     MULTI\_BUYER               0          1   
         1         3               FOOD    SINGLE\_BUYER               0          1   
         2         3  COSMETIC\_AND\_FOOD     MULTI\_BUYER               0          2   
         3         1           COSMETIC     MULTI\_BUYER               0          1   
         4         1               FOOD     MULTI\_BUYER               0          1   
         
            ALTERSKATEGORIE\_GROB  
         0                     4  
         1                     4  
         2                     4  
         3                     4  
         4                     3  
         
         [5 rows x 369 columns]
\end{Verbatim}
            
    Next, I am reading description of these columns to get an idea what
these attributes really means.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}14}]:} \PY{n}{dias\PYZus{}information} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}excel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{./DIAS Information Levels \PYZhy{} Attributes 2017.xlsx}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{dias\PYZus{}information}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Unnamed: 0}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
         \PY{n}{dias\PYZus{}information}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}14}]:}   Information level              Attribute  \textbackslash{}
         0               NaN               AGER\_TYP   
         1            Person   ALTERSKATEGORIE\_GROB   
         2               NaN              ANREDE\_KZ   
         3               NaN          CJT\_GESAMTTYP   
         4               NaN      FINANZ\_MINIMALIST   
         5               NaN          FINANZ\_SPARER   
         6               NaN       FINANZ\_VORSORGER   
         7               NaN         FINANZ\_ANLEGER   
         8               NaN  FINANZ\_UNAUFFAELLIGER   
         9               NaN       FINANZ\_HAUSBAUER   
         
                                                  Description  \textbackslash{}
         0                                 best-ager typology   
         1                      age through prename analysis    
         2                                             gender   
         3  Customer-Journey-Typology relating to the pref{\ldots}   
         4         financial typology: low financial interest   
         5                    financial typology: money saver   
         6                    financial typology: be prepared   
         7                       financial typology: investor   
         8                   financial typology: unremarkable   
         9    financial typology: main focus is the own house   
         
                                             Additional notes  
         0  in cooperation with Kantar TNS; the informatio{\ldots}  
         1  modelled on millions of first name-age-referen{\ldots}  
         2                                                NaN  
         3  relating to the preferred information, marketi{\ldots}  
         4  Gfk-Typology based on a representative househo{\ldots}  
         5                                                NaN  
         6                                                NaN  
         7                                                NaN  
         8                                                NaN  
         9                                                NaN  
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}15}]:} \PY{n}{dias\PYZus{}attributes} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}excel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{./DIAS Attributes \PYZhy{} Values 2017.xlsx}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{dias\PYZus{}attributes}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Unnamed: 0}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
         \PY{n}{dias\PYZus{}attributes}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}15}]:}               Attribute                                   Description  Value  \textbackslash{}
         0              AGER\_TYP                            best-ager typology     -1   
         1                   NaN                                           NaN      0   
         2                   NaN                                           NaN      1   
         3                   NaN                                           NaN      2   
         4                   NaN                                           NaN      3   
         5  ALTERSKATEGORIE\_GROB  age classification through prename analysis   -1, 0   
         6                   NaN                                           NaN      1   
         7                   NaN                                           NaN      2   
         8                   NaN                                           NaN      3   
         9                   NaN                                           NaN      4   
         
                               Meaning  
         0                     unknown  
         1  no classification possible  
         2             passive elderly  
         3            cultural elderly  
         4   experience-driven elderly  
         5                     unknown  
         6                  < 30 years  
         7               30 - 45 years  
         8               46 - 60 years  
         9                  > 60 years  
\end{Verbatim}
            
    It's not feasible to print out the whole attributes file, as it has
\textasciitilde{}2.3k rows. I will download the DIAS Attributes - Values
2017.xlsx file to see what different values means in different
categories.

    \paragraph{Convert missing value codes to
NaN}\label{convert-missing-value-codes-to-nan}

    I want to identify all the values which are unknown or contain no in the
meaning string. First, I will filter the dias\_attribute data frame and
using which the same I will replace the missing value code with NaNs.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}16}]:} \PY{n}{dias\PYZus{}attributes}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Attribute}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{dias\PYZus{}attributes}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Attribute}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{fillna}\PY{p}{(}\PY{n}{method}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ffill}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{dias\PYZus{}attributes} \PY{o}{=} \PY{n}{dias\PYZus{}attributes}\PY{p}{[}\PY{p}{(}\PY{n}{dias\PYZus{}attributes}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Meaning}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{str}\PY{o}{.}\PY{n}{contains}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{unknown}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)} \PY{o}{|} \PY{n}{dias\PYZus{}attributes}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Meaning}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{str}\PY{o}{.}\PY{n}{contains}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{no }\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{)}\PY{p}{]}
         \PY{n}{dias\PYZus{}attributes}\PY{p}{[}\PY{l+m+mi}{290}\PY{p}{:}\PY{p}{]}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}16}]:}                Attribute                                        Description  \textbackslash{}
         2194          SEMIO\_VERT  affinity indicating in what way the person is {\ldots}   
         2202         SHOPPER\_TYP                                  shopping typology   
         2207           SOHO\_FLAG                      small office/home office flag   
         2208           SOHO\_FLAG                                                NaN   
         2210            TITEL\_KZ   flag whether this person holds an academic title   
         2216            VERS\_TYP                                insurance typology    
         2219      WOHNDAUER\_2008                                length of residence   
         2229            WOHNLAGE                                  residential-area    
         2230            WOHNLAGE                                                NaN   
         2238  WACHSTUMSGEBIET\_NB  growing area (population growth in the last 5 {\ldots}   
         2244      W\_KEIT\_KIND\_HH    likelihood of a child present in this household   
         2251            ZABEOTYP                   typification of energy consumers   
         
               Value                      Meaning  
         2194  -1, 9                      unknown  
         2202     -1                      unknown  
         2207     -1                      unknown  
         2208      0  no small office/home office  
         2210  -1, 0                      unknown  
         2216     -1                      unknown  
         2219  -1, 0                      unknown  
         2229     -1                      unknown  
         2230      0          no score calculated  
         2238  -1, 0                      unknown  
         2244  -1, 0                      unknown  
         2251  -1, 9                      unknown  
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}17}]:} \PY{n}{unknowns} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{n}{features} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         
         \PY{k}{for} \PY{n}{feature} \PY{o+ow}{in} \PY{n}{dias\PYZus{}attributes}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Attribute}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{unique}\PY{p}{(}\PY{p}{)}\PY{p}{:}
             \PY{n}{missing\PYZus{}or\PYZus{}unknown} \PY{o}{=} \PY{n}{dias\PYZus{}attributes}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{dias\PYZus{}attributes}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Attribute}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{n}{feature}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Value}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{str}\PY{p}{)}\PY{o}{.}\PY{n}{str}\PY{o}{.}\PY{n}{cat}\PY{p}{(}\PY{n}{sep}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{,}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{o}{.}\PY{n}{split}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{,}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n}{unknowns}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{missing\PYZus{}or\PYZus{}unknown}\PY{p}{)}
             \PY{n}{features}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{feature}\PY{p}{)}
             
         \PY{n}{unknowns\PYZus{}df} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{concat}\PY{p}{(}\PY{p}{[}\PY{n}{pd}\PY{o}{.}\PY{n}{Series}\PY{p}{(}\PY{n}{features}\PY{p}{)}\PY{p}{,} \PY{n}{pd}\PY{o}{.}\PY{n}{Series}\PY{p}{(}\PY{n}{unknowns}\PY{p}{)}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{unknowns\PYZus{}df}\PY{o}{.}\PY{n}{columns} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{attribute}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{missing\PYZus{}or\PYZus{}unknown}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         \PY{n}{unknowns\PYZus{}df}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}17}]:}               attribute missing\_or\_unknown
         0              AGER\_TYP            [-1, 0]
         1  ALTERSKATEGORIE\_GROB           [-1,  0]
         2              ALTER\_HH                [0]
         3             ANREDE\_KZ           [-1,  0]
         4              BALLRAUM               [-1]
\end{Verbatim}
            
    \subsubsection{Replacing Nan's code with Nan
values}\label{replacing-nans-code-with-nan-values}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}18}]:} \PY{k}{def} \PY{n+nf}{replacing\PYZus{}with\PYZus{}nan}\PY{p}{(}\PY{n}{df}\PY{p}{,}\PY{n}{unknowns\PYZus{}df}\PY{p}{)}\PY{p}{:}
             \PY{k}{for} \PY{n}{row} \PY{o+ow}{in} \PY{n}{unknowns\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{attribute}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{:}
                 \PY{k}{if} \PY{n}{row} \PY{o+ow}{in} \PY{n}{df}\PY{o}{.}\PY{n}{columns}\PY{p}{:}
                     \PY{n}{na\PYZus{}map} \PY{o}{=} \PY{n}{unknowns\PYZus{}df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{unknowns\PYZus{}df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{attribute}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{==} \PY{n}{row}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{missing\PYZus{}or\PYZus{}unknown}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{iloc}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
                     \PY{n}{na\PYZus{}idx} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{p}{:}\PY{p}{,} \PY{n}{row}\PY{p}{]}\PY{o}{.}\PY{n}{isin}\PY{p}{(}\PY{n}{na\PYZus{}map}\PY{p}{)}
                     \PY{n}{df}\PY{o}{.}\PY{n}{loc}\PY{p}{[}\PY{n}{na\PYZus{}idx}\PY{p}{,} \PY{n}{row}\PY{p}{]} \PY{o}{=} \PY{n}{np}\PY{o}{.}\PY{n}{NaN}
                 \PY{k}{else}\PY{p}{:}
                     \PY{k}{continue}
                     
             \PY{k}{return} \PY{n}{df}
\end{Verbatim}


    Replacing unknown code values with NaN for both customers and azdias
dataset.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}19}]:} \PY{n}{customers} \PY{o}{=} \PY{n}{replacing\PYZus{}with\PYZus{}nan}\PY{p}{(}\PY{n}{customers}\PY{p}{,}\PY{n}{unknowns\PYZus{}df}\PY{p}{)}
         \PY{n}{customers}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}19}]:}       LNR  AGER\_TYP  AKT\_DAT\_KL  ALTER\_HH  ALTER\_KIND1  ALTER\_KIND2  \textbackslash{}
         0    9626       2.0         1.0      10.0          NaN          NaN   
         1    9628       NaN         9.0      11.0          NaN          NaN   
         2  143872       NaN         1.0       6.0          NaN          NaN   
         3  143873       1.0         1.0       8.0          NaN          NaN   
         4  143874       NaN         1.0      20.0          NaN          NaN   
         
            ALTER\_KIND3  ALTER\_KIND4  ALTERSKATEGORIE\_FEIN  ANZ\_HAUSHALTE\_AKTIV  \textbackslash{}
         0          NaN          NaN                  10.0                  1.0   
         1          NaN          NaN                   NaN                  NaN   
         2          NaN          NaN                   0.0                  1.0   
         3          NaN          NaN                   8.0                  0.0   
         4          NaN          NaN                  14.0                  7.0   
         
                    {\ldots}           VK\_ZG11  W\_KEIT\_KIND\_HH  WOHNDAUER\_2008  WOHNLAGE  \textbackslash{}
         0          {\ldots}               2.0             6.0             9.0       7.0   
         1          {\ldots}               3.0             NaN             9.0       NaN   
         2          {\ldots}              11.0             6.0             9.0       2.0   
         3          {\ldots}               2.0             NaN             9.0       7.0   
         4          {\ldots}               4.0             2.0             9.0       3.0   
         
            ZABEOTYP      PRODUCT\_GROUP  CUSTOMER\_GROUP ONLINE\_PURCHASE  ANREDE\_KZ  \textbackslash{}
         0       3.0  COSMETIC\_AND\_FOOD     MULTI\_BUYER               0        1.0   
         1       3.0               FOOD    SINGLE\_BUYER               0        1.0   
         2       3.0  COSMETIC\_AND\_FOOD     MULTI\_BUYER               0        2.0   
         3       1.0           COSMETIC     MULTI\_BUYER               0        1.0   
         4       1.0               FOOD     MULTI\_BUYER               0        1.0   
         
            ALTERSKATEGORIE\_GROB  
         0                   4.0  
         1                   4.0  
         2                   4.0  
         3                   4.0  
         4                   3.0  
         
         [5 rows x 369 columns]
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}20}]:} \PY{n}{azdias} \PY{o}{=} \PY{n}{replacing\PYZus{}with\PYZus{}nan}\PY{p}{(}\PY{n}{azdias}\PY{p}{,}\PY{n}{unknowns\PYZus{}df}\PY{p}{)}
         \PY{n}{azdias}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}20}]:}       LNR  AGER\_TYP  AKT\_DAT\_KL  ALTER\_HH  ALTER\_KIND1  ALTER\_KIND2  \textbackslash{}
         0  910215       NaN         NaN       NaN          NaN          NaN   
         1  910220       NaN         9.0       NaN          NaN          NaN   
         2  910225       NaN         9.0      17.0          NaN          NaN   
         3  910241       NaN         1.0      20.0          NaN          NaN   
         4  645165       NaN         1.0      10.0          NaN          NaN   
         
            ALTER\_KIND3  ALTER\_KIND4  ALTERSKATEGORIE\_FEIN  ANZ\_HAUSHALTE\_AKTIV  \textbackslash{}
         0          NaN          NaN                   NaN                  NaN   
         1          NaN          NaN                  21.0                 11.0   
         2          NaN          NaN                  17.0                 10.0   
         3          NaN          NaN                  14.0                  3.0   
         4          NaN          NaN                  10.0                  6.0   
         
                    {\ldots}           VHN  VK\_DHT4A  VK\_DISTANZ  VK\_ZG11  W\_KEIT\_KIND\_HH  \textbackslash{}
         0          {\ldots}           NaN       NaN         NaN      NaN             NaN   
         1          {\ldots}           4.0       8.0        11.0     10.0             3.0   
         2          {\ldots}           2.0       9.0         9.0      6.0             3.0   
         3          {\ldots}           2.0       3.0         5.0      4.0             2.0   
         4          {\ldots}           4.0       8.0        11.0     10.0             6.0   
         
            WOHNDAUER\_2008  WOHNLAGE ZABEOTYP  ANREDE\_KZ  ALTERSKATEGORIE\_GROB  
         0             NaN       NaN      3.0        1.0                   2.0  
         1             9.0       4.0      5.0        2.0                   1.0  
         2             9.0       2.0      5.0        2.0                   3.0  
         3             9.0       3.0      4.0        1.0                   3.0  
         4             9.0       5.0      3.0        2.0                   3.0  
         
         [5 rows x 366 columns]
\end{Verbatim}
            
    \subsubsection{Deleting columns with null
values}\label{deleting-columns-with-null-values}

\subparagraph{Handing Null Values and checking their
distributions}\label{handing-null-values-and-checking-their-distributions}

    First, let's see what is the distribution of null values accross the
columns. I am going to create a dataframe to store the percentage of
null values in columns.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}21}]:} \PY{k}{def} \PY{n+nf}{identify\PYZus{}columns\PYZus{}null\PYZus{}values}\PY{p}{(}\PY{n}{df}\PY{p}{)}\PY{p}{:}
             
             \PY{l+s+sd}{\PYZsq{}\PYZsq{}\PYZsq{}}
         \PY{l+s+sd}{    This function takes a dataframe as an input and resturn a list of all the columns where}
         \PY{l+s+sd}{    null values are more than 40\PYZpc{} of the total values in the column}
         \PY{l+s+sd}{    \PYZsq{}\PYZsq{}\PYZsq{}}
         
             \PY{n}{df\PYZus{}null} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{isnull}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{p}{)}
             \PY{n}{df\PYZus{}null\PYZus{}percent} \PY{o}{=} \PY{n}{df\PYZus{}null} \PY{o}{/} \PY{n+nb}{len}\PY{p}{(}\PY{n}{df}\PY{p}{)} \PY{o}{*} \PY{l+m+mi}{100}
         
             \PY{n}{df\PYZus{}null\PYZus{}percent}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{p}{)}\PY{p}{[}\PY{l+m+mi}{330}\PY{p}{:}\PY{p}{]}\PY{o}{.}\PY{n}{plot}\PY{o}{.}\PY{n}{barh}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{10}\PY{p}{,}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{,}\PY{n}{fontsize}\PY{o}{=}\PY{l+m+mi}{12}\PY{p}{,}\PY{n}{color}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{teal}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{columns having  missing values \PYZgt{}40}\PY{l+s+s1}{\PYZpc{}}\PY{l+s+s1}{ : }\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n+nb}{len}\PY{p}{(}\PY{n}{df\PYZus{}null\PYZus{}percent}\PY{p}{[}\PY{n}{df\PYZus{}null\PYZus{}percent}\PY{o}{\PYZgt{}}\PY{l+m+mi}{40}\PY{p}{]}\PY{o}{.}\PY{n}{index}\PY{p}{)}\PY{p}{)}
             
             \PY{n}{df\PYZus{}null\PYZus{}list} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n}{df\PYZus{}null\PYZus{}percent}\PY{p}{[}\PY{n}{df\PYZus{}null\PYZus{}percent}\PY{o}{\PYZgt{}}\PY{l+m+mi}{40}\PY{p}{]}\PY{o}{.}\PY{n}{index}\PY{p}{)}
             \PY{k}{return} \PY{n}{df\PYZus{}null\PYZus{}list}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}22}]:} \PY{n}{customers\PYZus{}null\PYZus{}list} \PY{o}{=} \PY{n}{identify\PYZus{}columns\PYZus{}null\PYZus{}values}\PY{p}{(}\PY{n}{customers}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
columns having  missing values >40\% :  37

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_36_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}23}]:} \PY{n}{azdias\PYZus{}null\PYZus{}list} \PY{o}{=} \PY{n}{identify\PYZus{}columns\PYZus{}null\PYZus{}values}\PY{p}{(}\PY{n}{azdias}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
columns having  missing values >40\% :  37

    \end{Verbatim}

    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_37_1.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}24}]:} \PY{n+nb}{len}\PY{p}{(}\PY{n+nb}{list}\PY{p}{(}\PY{n+nb}{set}\PY{p}{(}\PY{n}{customers\PYZus{}null\PYZus{}list}\PY{p}{)} \PY{o}{\PYZam{}} \PY{n+nb}{set}\PY{p}{(}\PY{n}{azdias\PYZus{}null\PYZus{}list}\PY{p}{)}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}24}]:} 36
\end{Verbatim}
            
    There are 36 columns where 40\% of the values are null are common in
both azdias and customers dataset.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}25}]:} \PY{n+nb}{len}\PY{p}{(}\PY{n+nb}{list}\PY{p}{(}\PY{n+nb}{set}\PY{p}{(}\PY{n}{customers\PYZus{}null\PYZus{}list}\PY{p}{)} \PY{o}{|} \PY{n+nb}{set}\PY{p}{(}\PY{n}{azdias\PYZus{}null\PYZus{}list}\PY{p}{)}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}25}]:} 38
\end{Verbatim}
            
    However, to remain consistent we need to remove all 38 columns from both
the dataset.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}26}]:} \PY{n}{columns\PYZus{}to\PYZus{}drop} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n+nb}{set}\PY{p}{(}\PY{n}{customers\PYZus{}null\PYZus{}list}\PY{p}{)} \PY{o}{|} \PY{n+nb}{set}\PY{p}{(}\PY{n}{azdias\PYZus{}null\PYZus{}list}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}27}]:} \PY{n}{azdias}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{columns\PYZus{}to\PYZus{}drop}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{inplace} \PY{o}{=} \PY{k+kc}{True}\PY{p}{)}
         \PY{n}{customers}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{columns\PYZus{}to\PYZus{}drop}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{inplace} \PY{o}{=} \PY{k+kc}{True}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}28}]:} \PY{n+nb}{print}\PY{p}{(}\PY{n}{azdias}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{customers}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
(222804, 328)
(191652, 331)

    \end{Verbatim}

    \subsubsection{Removing rows with missing
values}\label{removing-rows-with-missing-values}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}29}]:} \PY{n}{fig} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{20}\PY{p}{,}\PY{l+m+mi}{7}\PY{p}{)}\PY{p}{)}
         \PY{n}{azdias}\PY{o}{.}\PY{n}{isnull}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{.}\PY{n}{hist}\PY{p}{(}\PY{n}{bins}\PY{o}{=}\PY{l+m+mi}{20}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Missing Values per Row}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{;}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{} Features}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{} Rows}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{;}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_46_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    I'll use a threshold of 230 which means that rows that have more than
230 features missing will be dropped.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}30}]:} \PY{n}{azdias} \PY{o}{=} \PY{n}{azdias}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{n}{thresh}\PY{o}{=}\PY{l+m+mi}{230}\PY{p}{)}
         \PY{n}{azdias}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}30}]:} (196291, 328)
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}31}]:} \PY{n}{fig} \PY{o}{=} \PY{n}{plt}\PY{o}{.}\PY{n}{figure}\PY{p}{(}\PY{n}{figsize}\PY{o}{=}\PY{p}{(}\PY{l+m+mi}{20}\PY{p}{,}\PY{l+m+mi}{7}\PY{p}{)}\PY{p}{)}
         \PY{n}{customers}\PY{o}{.}\PY{n}{isnull}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{sum}\PY{p}{(}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{.}\PY{n}{hist}\PY{p}{(}\PY{n}{bins}\PY{o}{=}\PY{l+m+mi}{20}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Missing Values per Row}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{;}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{} Features}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{\PYZsh{} Rows}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}\PY{p}{;}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_49_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}32}]:} \PY{n}{customers} \PY{o}{=} \PY{n}{customers}\PY{o}{.}\PY{n}{dropna}\PY{p}{(}\PY{n}{thresh}\PY{o}{=}\PY{l+m+mi}{230}\PY{p}{)}
         \PY{n}{customers}\PY{o}{.}\PY{n}{shape}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}32}]:} (140371, 331)
\end{Verbatim}
            
    \subsubsection{Encoding features and feature
engineering}\label{encoding-features-and-feature-engineering}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}33}]:} \PY{n}{extra\PYZus{}col} \PY{o}{=} \PY{n+nb}{list}\PY{p}{(}\PY{n+nb}{set}\PY{p}{(}\PY{n}{customers}\PY{o}{.}\PY{n}{columns}\PY{p}{)} \PY{o}{\PYZhy{}} \PY{n+nb}{set}\PY{p}{(}\PY{n}{azdias}\PY{o}{.}\PY{n}{columns}\PY{p}{)}\PY{p}{)}
         \PY{n}{extra\PYZus{}col}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}33}]:} ['ONLINE\_PURCHASE', 'CUSTOMER\_GROUP', 'PRODUCT\_GROUP']
\end{Verbatim}
            
    We have three extra columns in customers dataset. We need to remove
these three columns from the customers dataset.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}34}]:} \PY{n}{customers} \PY{o}{=} \PY{n}{customers}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{n}{deep}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
         \PY{n}{azdias} \PY{o}{=} \PY{n}{azdias}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{n}{deep}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
         
         \PY{n}{customers}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{extra\PYZus{}col}\PY{p}{,} \PY{n}{axis} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{,} \PY{n}{inplace} \PY{o}{=} \PY{k+kc}{True}\PY{p}{)}
\end{Verbatim}


    From manual investigation, I found out that there are 6 numerical
columns

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}35}]:} \PY{n+nb}{print}\PY{p}{(}\PY{n}{azdias}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{customers}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
(196291, 328)
(140371, 328)

    \end{Verbatim}

    Next, I will identify the columns with only two values so that I can
convert them in binary columns.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}36}]:} \PY{n}{categorical\PYZus{}binary}\PY{o}{=}\PY{p}{[}\PY{p}{]}
         
         \PY{k}{for} \PY{n}{feature} \PY{o+ow}{in} \PY{n}{azdias}\PY{o}{.}\PY{n}{columns}\PY{p}{:}
             \PY{k}{if} \PY{n}{azdias}\PY{p}{[}\PY{n}{feature}\PY{p}{]}\PY{o}{.}\PY{n}{nunique}\PY{p}{(}\PY{p}{)} \PY{o}{==} \PY{l+m+mi}{2}\PY{p}{:}
                 \PY{n}{categorical\PYZus{}binary}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{feature}\PY{p}{)}
                 
         \PY{n}{categorical\PYZus{}binary}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}36}]:} ['DSL\_FLAG',
          'GREEN\_AVANTGARDE',
          'HH\_DELTA\_FLAG',
          'KBA05\_SEG6',
          'KONSUMZELLE',
          'OST\_WEST\_KZ',
          'SOHO\_KZ',
          'UNGLEICHENN\_FLAG',
          'VERS\_TYP',
          'ANREDE\_KZ']
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}37}]:} \PY{k}{for} \PY{n}{col} \PY{o+ow}{in} \PY{n}{categorical\PYZus{}binary}\PY{p}{:}
             \PY{n+nb}{print}\PY{p}{(}\PY{n}{azdias}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{o}{.}\PY{n}{value\PYZus{}counts}\PY{p}{(}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
1.0    191179
0.0      5112
Name: DSL\_FLAG, dtype: int64
0    153158
1     43133
Name: GREEN\_AVANTGARDE, dtype: int64
0.0    170275
1.0     17711
Name: HH\_DELTA\_FLAG, dtype: int64
0.0    162309
1.0     21849
Name: KBA05\_SEG6, dtype: int64
0.0    149878
1.0     46412
Name: KONSUMZELLE, dtype: int64
W    155014
O     41277
Name: OST\_WEST\_KZ, dtype: int64
0.0    194597
1.0      1694
Name: SOHO\_KZ, dtype: int64
0.0    178689
1.0     17602
Name: UNGLEICHENN\_FLAG, dtype: int64
2.0    97389
1.0    89813
Name: VERS\_TYP, dtype: int64
2.0    102645
1.0     93646
Name: ANREDE\_KZ, dtype: int64

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}38}]:} \PY{c+c1}{\PYZsh{}we need to convert OST\PYZus{}WEST\PYZus{}KZ categories from W and O to 0 and 1}
         \PY{n}{o\PYZus{}w\PYZus{}k\PYZus{}dict} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{W}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{O}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{l+m+mi}{1}\PY{p}{\PYZcb{}}
         \PY{n}{azdias}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{OST\PYZus{}WEST\PYZus{}KZ}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{azdias}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{OST\PYZus{}WEST\PYZus{}KZ}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{apply}\PY{p}{(}\PY{k}{lambda} \PY{n}{x}\PY{p}{:}\PY{n}{o\PYZus{}w\PYZus{}k\PYZus{}dict}\PY{p}{[}\PY{n}{x}\PY{p}{]}\PY{p}{)}
         \PY{n}{customers}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{OST\PYZus{}WEST\PYZus{}KZ}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{customers}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{OST\PYZus{}WEST\PYZus{}KZ}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{apply}\PY{p}{(}\PY{k}{lambda} \PY{n}{x}\PY{p}{:}\PY{n}{o\PYZus{}w\PYZus{}k\PYZus{}dict}\PY{p}{[}\PY{n}{x}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    I have identified a few columns, using which I will be creating a few
other columns, in order to capture information in a better way.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}39}]:} \PY{c+c1}{\PYZsh{}extract the time,and keep the year for column with date/time information}
         \PY{n}{azdias}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{EINGEFUEGT\PYZus{}AM}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{=}\PY{n}{pd}\PY{o}{.}\PY{n}{to\PYZus{}datetime}\PY{p}{(}\PY{n}{azdias}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{EINGEFUEGT\PYZus{}AM}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{dt}\PY{o}{.}\PY{n}{year}
         \PY{n}{customers}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{EINGEFUEGT\PYZus{}AM}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{=}\PY{n}{pd}\PY{o}{.}\PY{n}{to\PYZus{}datetime}\PY{p}{(}\PY{n}{customers}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{EINGEFUEGT\PYZus{}AM}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{dt}\PY{o}{.}\PY{n}{year}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}40}]:} \PY{c+c1}{\PYZsh{}extracting decade}
         \PY{n}{decades\PYZus{}dict} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+m+mi}{1}\PY{p}{:} \PY{l+m+mi}{40}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{:} \PY{l+m+mi}{40}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{:} \PY{l+m+mi}{50}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{:} \PY{l+m+mi}{50}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{:} \PY{l+m+mi}{60}\PY{p}{,} \PY{l+m+mi}{6}\PY{p}{:} \PY{l+m+mi}{60}\PY{p}{,} \PY{l+m+mi}{7}\PY{p}{:} \PY{l+m+mi}{60}\PY{p}{,}
                    \PY{l+m+mi}{8}\PY{p}{:} \PY{l+m+mi}{70}\PY{p}{,} \PY{l+m+mi}{9}\PY{p}{:} \PY{l+m+mi}{70}\PY{p}{,} \PY{l+m+mi}{10}\PY{p}{:} \PY{l+m+mi}{80}\PY{p}{,} \PY{l+m+mi}{11}\PY{p}{:} \PY{l+m+mi}{80}\PY{p}{,} \PY{l+m+mi}{12}\PY{p}{:} \PY{l+m+mi}{80}\PY{p}{,} \PY{l+m+mi}{13}\PY{p}{:} \PY{l+m+mi}{80}\PY{p}{,} \PY{l+m+mi}{14}\PY{p}{:} \PY{l+m+mi}{90}\PY{p}{,}
                    \PY{l+m+mi}{15}\PY{p}{:} \PY{l+m+mi}{90}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:} \PY{n}{np}\PY{o}{.}\PY{n}{nan}\PY{p}{\PYZcb{}}
         
         \PY{c+c1}{\PYZsh{}mainstream or avant\PYZhy{}garde movement}
         \PY{n}{movement\PYZus{}dict} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+m+mi}{1}\PY{p}{:} \PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{:} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{:} \PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{:} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{:} \PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{6}\PY{p}{:} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{7}\PY{p}{:} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{8}\PY{p}{:} \PY{l+m+mi}{0}\PY{p}{,}
                    \PY{l+m+mi}{9}\PY{p}{:} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{10}\PY{p}{:} \PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{11}\PY{p}{:} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{12}\PY{p}{:} \PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{13}\PY{p}{:} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{14}\PY{p}{:} \PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{15}\PY{p}{:} \PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:} \PY{n}{np}\PY{o}{.}\PY{n}{nan}\PY{p}{\PYZcb{}}
         
         \PY{n}{azdias}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{PRAEGENDE\PYZus{}JUGENDJAHRE\PYZus{}DECADE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{azdias}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{PRAEGENDE\PYZus{}JUGENDJAHRE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{map}\PY{p}{(}\PY{n}{decades\PYZus{}dict}\PY{p}{)}
         \PY{n}{customers}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{PRAEGENDE\PYZus{}JUGENDJAHRE\PYZus{}DECADE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{customers}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{PRAEGENDE\PYZus{}JUGENDJAHRE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{map}\PY{p}{(}\PY{n}{decades\PYZus{}dict}\PY{p}{)}
         
         \PY{n}{azdias}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{PRAEGENDE\PYZus{}JUGENDJAHRE\PYZus{}MOVEMENT}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{azdias}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{PRAEGENDE\PYZus{}JUGENDJAHRE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{map}\PY{p}{(}\PY{n}{movement\PYZus{}dict}\PY{p}{)}
         \PY{n}{customers}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{PRAEGENDE\PYZus{}JUGENDJAHRE\PYZus{}MOVEMENT}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{customers}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{PRAEGENDE\PYZus{}JUGENDJAHRE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{map}\PY{p}{(}\PY{n}{movement\PYZus{}dict}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}41}]:} \PY{c+c1}{\PYZsh{}Using CAMEO\PYZus{}INTL\PYZus{}2015 to create a wealth and family type feature}
         \PY{n}{azdias}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{WEALTH}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{azdias}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{CAMEO\PYZus{}INTL\PYZus{}2015}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{apply}\PY{p}{(}\PY{k}{lambda} \PY{n}{x}\PY{p}{:} \PY{n}{np}\PY{o}{.}\PY{n}{floor}\PY{p}{(}\PY{n}{pd}\PY{o}{.}\PY{n}{to\PYZus{}numeric}\PY{p}{(}\PY{n}{x}\PY{p}{)}\PY{o}{/}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{)}
         \PY{n}{azdias}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{LIFE\PYZus{}STAGE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{azdias}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{CAMEO\PYZus{}INTL\PYZus{}2015}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{apply}\PY{p}{(}\PY{k}{lambda} \PY{n}{x}\PY{p}{:} \PY{n}{pd}\PY{o}{.}\PY{n}{to\PYZus{}numeric}\PY{p}{(}\PY{n}{x}\PY{p}{)}\PY{o}{\PYZpc{}}\PY{k}{10})
         
         \PY{n}{customers}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{WEALTH}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{customers}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{CAMEO\PYZus{}INTL\PYZus{}2015}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{apply}\PY{p}{(}\PY{k}{lambda} \PY{n}{x}\PY{p}{:} \PY{n}{np}\PY{o}{.}\PY{n}{floor}\PY{p}{(}\PY{n}{pd}\PY{o}{.}\PY{n}{to\PYZus{}numeric}\PY{p}{(}\PY{n}{x}\PY{p}{)}\PY{o}{/}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{)}
         \PY{n}{customers}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{LIFE\PYZus{}STAGE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{customers}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{CAMEO\PYZus{}INTL\PYZus{}2015}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{apply}\PY{p}{(}\PY{k}{lambda} \PY{n}{x}\PY{p}{:} \PY{n}{pd}\PY{o}{.}\PY{n}{to\PYZus{}numeric}\PY{p}{(}\PY{n}{x}\PY{p}{)}\PY{o}{\PYZpc{}}\PY{k}{10})
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}42}]:} \PY{c+c1}{\PYZsh{}dealing with LP\PYZus{}LEBENSPHASE\PYZus{}FEIN}
         \PY{n}{life\PYZus{}stage} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+m+mi}{1}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{younger\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{middle\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{younger\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                       \PY{l+m+mi}{4}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{middle\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{advanced\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{6}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{retirement\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                       \PY{l+m+mi}{7}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{advanced\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{8}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{retirement\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{9}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{middle\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                       \PY{l+m+mi}{10}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{middle\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{11}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{advanced\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{12}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{retirement\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                       \PY{l+m+mi}{13}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{advanced\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{14}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{younger\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{15}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{advanced\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                       \PY{l+m+mi}{16}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{advanced\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{17}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{middle\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{18}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{younger\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                       \PY{l+m+mi}{19}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{advanced\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{20}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{advanced\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{21}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{middle\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                       \PY{l+m+mi}{22}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{middle\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{23}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{middle\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{24}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{middle\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                       \PY{l+m+mi}{25}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{middle\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{26}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{middle\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{27}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{middle\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                       \PY{l+m+mi}{28}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{middle\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{29}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{younger\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{30}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{younger\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                       \PY{l+m+mi}{31}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{advanced\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{32}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{advanced\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{33}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{younger\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                       \PY{l+m+mi}{34}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{younger\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{35}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{younger\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{36}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{advanced\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                       \PY{l+m+mi}{37}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{advanced\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{38}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{retirement\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{39}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{middle\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                       \PY{l+m+mi}{40}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{retirement\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}
         
         \PY{n}{fine\PYZus{}scale} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+m+mi}{1}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{low}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{low}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{average}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{average}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{low}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{6}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{low}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                       \PY{l+m+mi}{7}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{average}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{8}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{average}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{9}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{average}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{10}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{wealthy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{11}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{average}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                       \PY{l+m+mi}{12}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{average}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{13}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{top}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{14}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{average}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{15}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{low}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{16}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{average}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                       \PY{l+m+mi}{17}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{average}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{18}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{wealthy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{19}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{wealthy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{20}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{top}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{21}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{low}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                       \PY{l+m+mi}{22}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{average}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{23}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{wealthy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{24}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{low}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{25}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{average}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{26}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{average}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                       \PY{l+m+mi}{27}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{average}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{28}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{top}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{29}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{low}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{30}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{average}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{31}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{low}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                       \PY{l+m+mi}{32}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{average}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{33}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{average}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{34}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{average}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{35}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{top}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{36}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{average}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                       \PY{l+m+mi}{37}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{average}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{38}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{average}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{39}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{top}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{40}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{top}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}
         
         \PY{n}{life\PYZus{}dict} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{younger\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{middle\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{2}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{advanced\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{3}\PY{p}{,}
                     \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{retirement\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{4}\PY{p}{\PYZcb{}}
         \PY{n}{scale\PYZus{}dict} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{low}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{average}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{2}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{wealthy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{3}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{top}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{4}\PY{p}{\PYZcb{}}
         
         \PY{n}{azdias}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{LP\PYZus{}LEBENSPHASE\PYZus{}FEIN\PYZus{}life\PYZus{}stage}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{azdias}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{LP\PYZus{}LEBENSPHASE\PYZus{}FEIN}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{map}\PY{p}{(}\PY{n}{life\PYZus{}stage}\PY{p}{)}
         \PY{n}{azdias}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{LP\PYZus{}LEBENSPHASE\PYZus{}FEIN\PYZus{}fine\PYZus{}scale}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{azdias}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{LP\PYZus{}LEBENSPHASE\PYZus{}FEIN}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{map}\PY{p}{(}\PY{n}{fine\PYZus{}scale}\PY{p}{)}
         \PY{n}{azdias}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{LP\PYZus{}LEBENSPHASE\PYZus{}FEIN\PYZus{}life\PYZus{}stage}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{azdias}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{LP\PYZus{}LEBENSPHASE\PYZus{}FEIN\PYZus{}life\PYZus{}stage}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{map}\PY{p}{(}\PY{n}{life\PYZus{}dict}\PY{p}{)}
         \PY{n}{azdias}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{LP\PYZus{}LEBENSPHASE\PYZus{}FEIN\PYZus{}fine\PYZus{}scale}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{azdias}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{LP\PYZus{}LEBENSPHASE\PYZus{}FEIN\PYZus{}fine\PYZus{}scale}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{map}\PY{p}{(}\PY{n}{scale\PYZus{}dict}\PY{p}{)}
         
         
         \PY{n}{customers}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{LP\PYZus{}LEBENSPHASE\PYZus{}FEIN\PYZus{}life\PYZus{}stage}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{customers}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{LP\PYZus{}LEBENSPHASE\PYZus{}FEIN}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{map}\PY{p}{(}\PY{n}{life\PYZus{}stage}\PY{p}{)}
         \PY{n}{customers}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{LP\PYZus{}LEBENSPHASE\PYZus{}FEIN\PYZus{}fine\PYZus{}scale}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{customers}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{LP\PYZus{}LEBENSPHASE\PYZus{}FEIN}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{map}\PY{p}{(}\PY{n}{fine\PYZus{}scale}\PY{p}{)}
         \PY{n}{customers}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{LP\PYZus{}LEBENSPHASE\PYZus{}FEIN\PYZus{}life\PYZus{}stage}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{customers}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{LP\PYZus{}LEBENSPHASE\PYZus{}FEIN\PYZus{}life\PYZus{}stage}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{map}\PY{p}{(}\PY{n}{life\PYZus{}dict}\PY{p}{)}
         \PY{n}{customers}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{LP\PYZus{}LEBENSPHASE\PYZus{}FEIN\PYZus{}fine\PYZus{}scale}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{customers}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{LP\PYZus{}LEBENSPHASE\PYZus{}FEIN\PYZus{}fine\PYZus{}scale}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{map}\PY{p}{(}\PY{n}{scale\PYZus{}dict}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}43}]:} \PY{c+c1}{\PYZsh{}dropping columns used to create new features}
         \PY{c+c1}{\PYZsh{}Also deleting column LP\PYZus{}LEBENSPHASE\PYZus{}FEIN as it contains same information as }
         \PY{n}{cols} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{PRAEGENDE\PYZus{}JUGENDJAHRE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{CAMEO\PYZus{}INTL\PYZus{}2015}\PY{l+s+s1}{\PYZsq{}} \PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{LP\PYZus{}LEBENSPHASE\PYZus{}FEIN}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{LP\PYZus{}LEBENSPHASE\PYZus{}GROB}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
             
         \PY{n}{azdias}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{cols}\PY{p}{,} \PY{n}{axis} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{,} \PY{n}{inplace} \PY{o}{=} \PY{k+kc}{True}\PY{p}{)}
         \PY{n}{customers}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{cols}\PY{p}{,} \PY{n}{axis} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{,} \PY{n}{inplace} \PY{o}{=} \PY{k+kc}{True}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}44}]:} \PY{n+nb}{print}\PY{p}{(}\PY{n}{azdias}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{customers}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
(196291, 330)
(140371, 330)

    \end{Verbatim}

    I have identified a few categorical columns where I will be applying One
hot encoding and the rest I will be treating as numerical columns.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}45}]:} \PY{n}{cat\PYZus{}features} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{CAMEO\PYZus{}DEU\PYZus{}2015}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{CAMEO\PYZus{}DEUG\PYZus{}2015}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{CJT\PYZus{}GESAMTTYP}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{D19\PYZus{}KONSUMTYP}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                         \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{D19\PYZus{}LETZTER\PYZus{}KAUF\PYZus{}BRANCHE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FINANZTYP}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{GEBAEUDETYP}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{GEBAEUDETYP\PYZus{}RASTER}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{GFK\PYZus{}URLAUBERTYP}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                         \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HEALTH\PYZus{}TYP}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{KBA05\PYZus{}HERSTTEMP}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{KBA05\PYZus{}MAXHERST}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{KBA05\PYZus{}MAXSEG}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                         \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{LP\PYZus{}FAMILIE\PYZus{}FEIN}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{KBA05\PYZus{}MODTEMP}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{LP\PYZus{}FAMILIE\PYZus{}GROB}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RETOURTYP\PYZus{}BK\PYZus{}S}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                         \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{LP\PYZus{}STATUS\PYZus{}FEIN}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{LP\PYZus{}STATUS\PYZus{}GROB}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NATIONALITAET\PYZus{}KZ}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SHOPPER\PYZus{}TYP}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ZABEOTYP}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{WOHNLAGE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         
         \PY{n}{azdias\PYZus{}cat\PYZus{}ohe} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{get\PYZus{}dummies}\PY{p}{(}\PY{n}{azdias}\PY{p}{,} \PY{n}{columns} \PY{o}{=} \PY{n}{cat\PYZus{}features}\PY{p}{)}
         \PY{n}{customers\PYZus{}cat\PYZus{}ohe} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{get\PYZus{}dummies}\PY{p}{(}\PY{n}{customers}\PY{p}{,} \PY{n}{columns} \PY{o}{=} \PY{n}{cat\PYZus{}features}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}46}]:} \PY{n+nb}{print}\PY{p}{(}\PY{n}{azdias\PYZus{}cat\PYZus{}ohe}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{customers\PYZus{}cat\PYZus{}ohe}\PY{o}{.}\PY{n}{shape}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
(196291, 519)
(140371, 519)

    \end{Verbatim}

    \subsubsection{Imputing missing values with most frquent
value}\label{imputing-missing-values-with-most-frquent-value}

    Initially I tried Imputer from sklearn but received an error "could not
convert string to float: 'W'". That's why I decided to write my custom
impute function

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}47}]:} \PY{k}{def} \PY{n+nf}{impute}\PY{p}{(}\PY{n}{df}\PY{p}{)}\PY{p}{:}
             \PY{l+s+sd}{\PYZdq{}\PYZdq{}\PYZdq{}}
         \PY{l+s+sd}{    Imputes the most frequent value per column.}
         \PY{l+s+sd}{    \PYZdq{}\PYZdq{}\PYZdq{}}
             \PY{n}{df\PYZus{}copy} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{p}{)}
             \PY{n}{columns} \PY{o}{=} \PY{n}{df\PYZus{}copy}\PY{o}{.}\PY{n}{columns}\PY{p}{[}\PY{n}{df\PYZus{}copy}\PY{o}{.}\PY{n}{isnull}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{any}\PY{p}{(}\PY{p}{)}\PY{p}{]}
             
             \PY{k}{for} \PY{n}{col} \PY{o+ow}{in} \PY{n}{columns}\PY{p}{:}
                 \PY{n}{most\PYZus{}freq} \PY{o}{=} \PY{n}{df\PYZus{}copy}\PY{o}{.}\PY{n}{groupby}\PY{p}{(}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{p}{)}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{o}{.}\PY{n}{count}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{sort\PYZus{}values}\PY{p}{(}\PY{n}{ascending}\PY{o}{=}\PY{k+kc}{False}\PY{p}{)}\PY{o}{.}\PY{n}{index}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}
                 \PY{n}{df\PYZus{}copy}\PY{p}{[}\PY{n}{col}\PY{p}{]}\PY{o}{.}\PY{n}{fillna}\PY{p}{(}\PY{n}{most\PYZus{}freq}\PY{p}{,} \PY{n}{inplace}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
             
             \PY{k}{return} \PY{n}{df\PYZus{}copy}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}48}]:} \PY{n}{azdias\PYZus{}impute} \PY{o}{=} \PY{n}{impute}\PY{p}{(}\PY{n}{azdias\PYZus{}cat\PYZus{}ohe}\PY{p}{)}
         \PY{n}{azdias}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}48}]:}       LNR  AKT\_DAT\_KL  ALTER\_HH  ALTERSKATEGORIE\_FEIN  ANZ\_HAUSHALTE\_AKTIV  \textbackslash{}
         1  910220         9.0       NaN                  21.0                 11.0   
         2  910225         9.0      17.0                  17.0                 10.0   
         3  910241         1.0      20.0                  14.0                  3.0   
         4  645165         1.0      10.0                  10.0                  6.0   
         5  612574         1.0      19.0                  19.0                  0.0   
         
            ANZ\_HH\_TITEL  ANZ\_KINDER  ANZ\_PERSONEN  ANZ\_STATISTISCHE\_HAUSHALTE  \textbackslash{}
         1           0.0         0.0           2.0                        12.0   
         2           0.0         0.0           1.0                         7.0   
         3           0.0         0.0           4.0                         3.0   
         4           0.0         0.0           1.0                         6.0   
         5           0.0         0.0           0.0                         1.0   
         
            ANZ\_TITEL               {\ldots}                WOHNLAGE  ZABEOTYP ANREDE\_KZ  \textbackslash{}
         1        0.0               {\ldots}                     4.0       5.0       2.0   
         2        0.0               {\ldots}                     2.0       5.0       2.0   
         3        0.0               {\ldots}                     3.0       4.0       1.0   
         4        0.0               {\ldots}                     5.0       3.0       2.0   
         5        0.0               {\ldots}                     7.0       5.0       2.0   
         
            ALTERSKATEGORIE\_GROB  PRAEGENDE\_JUGENDJAHRE\_DECADE  \textbackslash{}
         1                   1.0                          90.0   
         2                   3.0                          90.0   
         3                   3.0                          70.0   
         4                   3.0                          50.0   
         5                   1.0                          90.0   
         
            PRAEGENDE\_JUGENDJAHRE\_MOVEMENT  WEALTH  LIFE\_STAGE  \textbackslash{}
         1                             0.0     5.0         1.0   
         2                             1.0     2.0         4.0   
         3                             0.0     4.0         3.0   
         4                             0.0     5.0         1.0   
         5                             0.0     4.0         1.0   
         
            LP\_LEBENSPHASE\_FEIN\_life\_stage  LP\_LEBENSPHASE\_FEIN\_fine\_scale  
         1                             2.0                             1.0  
         2                             1.0                             2.0  
         3                             3.0                             2.0  
         4                             4.0                             1.0  
         5                             NaN                             NaN  
         
         [5 rows x 330 columns]
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}49}]:} \PY{n}{customers\PYZus{}impute} \PY{o}{=} \PY{n}{impute}\PY{p}{(}\PY{n}{customers\PYZus{}cat\PYZus{}ohe}\PY{p}{)}
         \PY{n}{customers}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}49}]:}       LNR  AKT\_DAT\_KL  ALTER\_HH  ALTERSKATEGORIE\_FEIN  ANZ\_HAUSHALTE\_AKTIV  \textbackslash{}
         0    9626         1.0      10.0                  10.0                  1.0   
         2  143872         1.0       6.0                   0.0                  1.0   
         3  143873         1.0       8.0                   8.0                  0.0   
         4  143874         1.0      20.0                  14.0                  7.0   
         5  143888         1.0      11.0                  10.0                  1.0   
         
            ANZ\_HH\_TITEL  ANZ\_KINDER  ANZ\_PERSONEN  ANZ\_STATISTISCHE\_HAUSHALTE  \textbackslash{}
         0           0.0         0.0           2.0                         1.0   
         2           0.0         0.0           1.0                         1.0   
         3           NaN         0.0           0.0                         1.0   
         4           0.0         0.0           4.0                         7.0   
         5           0.0         0.0           2.0                         1.0   
         
            ANZ\_TITEL               {\ldots}                WOHNLAGE  ZABEOTYP ANREDE\_KZ  \textbackslash{}
         0        0.0               {\ldots}                     7.0       3.0       1.0   
         2        0.0               {\ldots}                     2.0       3.0       2.0   
         3        0.0               {\ldots}                     7.0       1.0       1.0   
         4        0.0               {\ldots}                     3.0       1.0       1.0   
         5        0.0               {\ldots}                     1.0       2.0       1.0   
         
            ALTERSKATEGORIE\_GROB  PRAEGENDE\_JUGENDJAHRE\_DECADE  \textbackslash{}
         0                   4.0                          50.0   
         2                   4.0                          50.0   
         3                   4.0                          40.0   
         4                   3.0                          70.0   
         5                   3.0                          50.0   
         
            PRAEGENDE\_JUGENDJAHRE\_MOVEMENT  WEALTH  LIFE\_STAGE  \textbackslash{}
         0                             1.0     1.0         3.0   
         2                             1.0     3.0         4.0   
         3                             0.0     2.0         4.0   
         4                             0.0     4.0         1.0   
         5                             1.0     3.0         4.0   
         
            LP\_LEBENSPHASE\_FEIN\_life\_stage  LP\_LEBENSPHASE\_FEIN\_fine\_scale  
         0                             3.0                             4.0  
         2                             3.0                             4.0  
         3                             NaN                             NaN  
         4                             3.0                             1.0  
         5                             2.0                             2.0  
         
         [5 rows x 330 columns]
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}50}]:} \PY{k+kn}{import} \PY{n+nn}{pickle}
         
         \PY{c+c1}{\PYZsh{} Dump the dataframe to a pickle object so that I don\PYZsq{}t have to run the process every time}
         \PY{n}{pickle}\PY{o}{.}\PY{n}{dump}\PY{p}{(}\PY{n}{azdias\PYZus{}impute}\PY{p}{,} \PY{n+nb}{open}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{azdias\PYZus{}impute.pickle}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{wb}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{)}
         \PY{n}{pickle}\PY{o}{.}\PY{n}{dump}\PY{p}{(}\PY{n}{customers\PYZus{}impute}\PY{p}{,} \PY{n+nb}{open}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{customers\PYZus{}impute.pickle}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{wb}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    As we can see the number of columns is 519, which is very high. The next
logical step would be to apply a dimensionality reduction technique to
reduce the number of columns(dimensions). I will apply standard scaling
to the features before applying PCA, so that principal component vectors
won't get affected by variation in the data

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor} }]:} \PY{c+c1}{\PYZsh{} Reload cleaned azdias object as saved after above analysis (may need to rerun imports)}
        \PY{n}{azdias\PYZus{}impute} \PY{o}{=} \PY{n}{pickle}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{n+nb}{open}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{azdias\PYZus{}impute.pickle}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{rb}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{)}
        \PY{n}{customers\PYZus{}impute} \PY{o}{=} \PY{n}{pickle}\PY{o}{.}\PY{n}{load}\PY{p}{(}\PY{n+nb}{open}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{customers\PYZus{}impute.pickle}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{rb}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}51}]:} \PY{n}{scaler} \PY{o}{=} \PY{n}{MinMaxScaler}\PY{p}{(}\PY{p}{)}
         \PY{n}{azdias\PYZus{}scaled} \PY{o}{=} \PY{n}{scaler}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{azdias\PYZus{}impute}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{float}\PY{p}{)}\PY{p}{)}
         \PY{n}{customers\PYZus{}scaled} \PY{o}{=} \PY{n}{scaler}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{customers\PYZus{}impute}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{float}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \subsubsection{Perform Dimensionality
Reduction}\label{perform-dimensionality-reduction}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}52}]:} \PY{n}{pca\PYZus{}azdias} \PY{o}{=} \PY{n}{PCA}\PY{p}{(}\PY{p}{)}
         \PY{n}{azdias\PYZus{}pca} \PY{o}{=} \PY{n}{pca\PYZus{}azdias}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{azdias\PYZus{}scaled}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}53}]:} \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{cumsum}\PY{p}{(}\PY{n}{pca\PYZus{}azdias}\PY{o}{.}\PY{n}{explained\PYZus{}variance\PYZus{}ratio\PYZus{}}\PY{p}{)}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Number of Components}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Explained Variance Ratio}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Explained Variance Ratio vs Number of Components in azdias dataset}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{n}{b}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_82_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}54}]:} \PY{n}{pca\PYZus{}customers} \PY{o}{=} \PY{n}{PCA}\PY{p}{(}\PY{p}{)}
         \PY{n}{customers\PYZus{}pca} \PY{o}{=} \PY{n}{pca\PYZus{}customers}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{customers\PYZus{}scaled}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}55}]:} \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{np}\PY{o}{.}\PY{n}{cumsum}\PY{p}{(}\PY{n}{pca\PYZus{}customers}\PY{o}{.}\PY{n}{explained\PYZus{}variance\PYZus{}ratio\PYZus{}}\PY{p}{)}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Number of Components}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Explained Variance Ratio}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Explained Variance Ratio vs Number of Components in customers dataset}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{grid}\PY{p}{(}\PY{n}{b}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_84_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    As we can see from the Explained varince ratio vs Number of components
graph, approximately 150 components covers more than 80\% of the
variance. I will refit the PCA with 150 components to cover 80+\% of the
variance in the datset.

    Interpreting Dimensionality Reduction

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}56}]:} \PY{k}{def} \PY{n+nf}{identify\PYZus{}important\PYZus{}features}\PY{p}{(}\PY{n}{df}\PY{p}{,}\PY{n}{pca}\PY{p}{,}\PY{n}{component}\PY{p}{)}\PY{p}{:}
             \PY{l+s+sd}{\PYZsq{}\PYZsq{}\PYZsq{}}
         \PY{l+s+sd}{    This function returns the top 5 features (both negative and positive contibution) }
         \PY{l+s+sd}{    in a particular component}
         \PY{l+s+sd}{    \PYZsq{}\PYZsq{}\PYZsq{}}
             \PY{n}{features} \PY{o}{=} \PY{n}{df}\PY{o}{.}\PY{n}{columns}\PY{o}{.}\PY{n}{values}
             \PY{n}{components} \PY{o}{=} \PY{n}{pca}\PY{o}{.}\PY{n}{components\PYZus{}}
             \PY{n}{feature\PYZus{}weights} \PY{o}{=} \PY{n+nb}{dict}\PY{p}{(}\PY{n+nb}{zip}\PY{p}{(}\PY{n}{features}\PY{p}{,} \PY{n}{components}\PY{p}{[}\PY{n}{component}\PY{p}{]}\PY{p}{)}\PY{p}{)}
             \PY{n}{feature\PYZus{}weights} \PY{o}{=} \PY{p}{\PYZob{}}\PY{n}{k}\PY{p}{:} \PY{n}{v} \PY{k}{for} \PY{n}{k}\PY{p}{,} \PY{n}{v} \PY{o+ow}{in} \PY{n+nb}{sorted}\PY{p}{(}\PY{n}{feature\PYZus{}weights}\PY{o}{.}\PY{n}{items}\PY{p}{(}\PY{p}{)}\PY{p}{,} \PY{n}{key}\PY{o}{=}\PY{k}{lambda} \PY{n}{x}\PY{p}{:} \PY{n+nb}{abs}\PY{p}{(}\PY{n}{x}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}\PY{p}{)}\PY{p}{\PYZcb{}}
             
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Component with highest contribution}\PY{l+s+s2}{\PYZdq{}}\PY{p}{)}
             \PY{k}{for} \PY{n}{key} \PY{o+ow}{in} \PY{n+nb}{list}\PY{p}{(}\PY{n}{feature\PYZus{}weights}\PY{o}{.}\PY{n}{keys}\PY{p}{(}\PY{p}{)}\PY{p}{)}\PY{p}{[}\PY{p}{:}\PY{l+m+mi}{10}\PY{p}{]}\PY{p}{:}
                 \PY{n+nb}{print}\PY{p}{(}\PY{n}{key}\PY{p}{,}\PY{n}{feature\PYZus{}weights}\PY{p}{[}\PY{n}{key}\PY{p}{]}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}57}]:} \PY{n}{identify\PYZus{}important\PYZus{}features}\PY{p}{(}\PY{n}{azdias}\PY{p}{,}\PY{n}{pca\PYZus{}azdias}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Component with highest contribution
KBA13\_HALTER\_55 -4.4634226537e-06
PRAEGENDE\_JUGENDJAHRE\_MOVEMENT -0.000169575494818
LP\_LEBENSPHASE\_FEIN\_fine\_scale -0.000222397367353
ANZ\_TITEL -0.000252625013952
D19\_SCHUHE -0.000280010547627
KBA13\_GBZ 0.000371303467067
D19\_TIERARTIKEL -0.000372451853854
REGIOTYP -0.00040335654098
D19\_TELKO\_REST 0.000487668916579
ANZ\_HH\_TITEL 0.000788473759042

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}58}]:} \PY{n}{identify\PYZus{}important\PYZus{}features}\PY{p}{(}\PY{n}{customers}\PY{p}{,}\PY{n}{pca\PYZus{}customers}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Component with highest contribution
KBA13\_HALTER\_66 3.67596631997e-05
KBA13\_CCM\_1500 6.76569583657e-05
D19\_VERSI\_ONLINE\_DATUM 6.87307695074e-05
ANZ\_TITEL -8.2307153559e-05
LNR -0.000139040208202
REGIOTYP 0.000183072658889
KBA13\_HALTER\_50 -0.000203263583089
LP\_LEBENSPHASE\_FEIN\_fine\_scale 0.000331807364678
D19\_SCHUHE -0.000337604902158
CJT\_TYP\_3 0.00033786553723

    \end{Verbatim}

    As we can see, features (ANZ\_TITEL, LP\_LEBENSPHASE\_FEIN\_fine\_scale,
D19\_SCHUHE, REGIOTYP etc.) are common in the first component of both
the pca's.

    \subsection{Part 1: Customer Segmentation
Report}\label{part-1-customer-segmentation-report}

The main bulk of your analysis will come in this part of the project.
Here, you should use unsupervised learning techniques to describe the
relationship between the demographics of the company's existing
customers and the general population of Germany. By the end of this
part, you should be able to describe parts of the general population
that are more likely to be part of the mail-order company's main
customer base, and which parts of the general population are less so.

    \subparagraph{Running PCA again with 150
components}\label{running-pca-again-with-150-components}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}59}]:} \PY{n}{pca1} \PY{o}{=} \PY{n}{PCA}\PY{p}{(}\PY{l+m+mi}{150}\PY{p}{)}
         \PY{n}{azdias\PYZus{}pca} \PY{o}{=} \PY{n}{pca1}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{azdias\PYZus{}scaled}\PY{p}{)}
         
         \PY{n}{pca2} \PY{o}{=} \PY{n}{PCA}\PY{p}{(}\PY{l+m+mi}{150}\PY{p}{)}
         \PY{n}{customers\PYZus{}pca} \PY{o}{=} \PY{n}{pca2}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{customers\PYZus{}scaled}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}60}]:} \PY{n}{Sum\PYZus{}of\PYZus{}squared\PYZus{}distances} \PY{o}{=} \PY{p}{[}\PY{p}{]}
         \PY{n}{K} \PY{o}{=} \PY{n+nb}{range}\PY{p}{(}\PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{15}\PY{p}{)}
         \PY{k}{for} \PY{n}{k} \PY{o+ow}{in} \PY{n}{K}\PY{p}{:}
             \PY{n}{km} \PY{o}{=} \PY{n}{KMeans}\PY{p}{(}\PY{n}{n\PYZus{}clusters}\PY{o}{=}\PY{n}{k}\PY{p}{)}
             \PY{n}{km} \PY{o}{=} \PY{n}{km}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{azdias\PYZus{}pca}\PY{p}{)}
             \PY{n}{Sum\PYZus{}of\PYZus{}squared\PYZus{}distances}\PY{o}{.}\PY{n}{append}\PY{p}{(}\PY{n}{km}\PY{o}{.}\PY{n}{inertia\PYZus{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}61}]:} \PY{n}{plt}\PY{o}{.}\PY{n}{plot}\PY{p}{(}\PY{n}{K}\PY{p}{,} \PY{n}{Sum\PYZus{}of\PYZus{}squared\PYZus{}distances}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{bx\PYZhy{}}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{xlabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{ylabel}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Sum\PYZus{}of\PYZus{}squared\PYZus{}distances}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{title}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{Elbow Method For Optimal k}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
         \PY{n}{plt}\PY{o}{.}\PY{n}{show}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


    \begin{center}
    \adjustimage{max size={0.9\linewidth}{0.9\paperheight}}{output_95_0.png}
    \end{center}
    { \hspace*{\fill} \\}
    
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}62}]:} \PY{c+c1}{\PYZsh{} from the elbow curve we can the optimum number of clusters is 10, refitting kmeans with 10 clusters}
         
         \PY{n}{kmeans} \PY{o}{=} \PY{n}{KMeans}\PY{p}{(}\PY{n}{n\PYZus{}clusters}\PY{o}{=}\PY{l+m+mi}{10}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{42}\PY{p}{,} \PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{azdias\PYZus{}predictions} \PY{o}{=} \PY{n}{kmeans}\PY{o}{.}\PY{n}{fit\PYZus{}predict}\PY{p}{(}\PY{n}{azdias\PYZus{}pca}\PY{p}{)}
         \PY{n}{customers\PYZus{}predictions} \PY{o}{=} \PY{n}{kmeans}\PY{o}{.}\PY{n}{predict}\PY{p}{(}\PY{n}{customers\PYZus{}pca}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}63}]:} \PY{c+c1}{\PYZsh{}checking predictions}
         \PY{n}{customers\PYZus{}predictions}\PY{p}{[}\PY{p}{:}\PY{l+m+mi}{20}\PY{p}{]}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}63}]:} array([6, 2, 4, 0, 2, 6, 6, 5, 9, 6, 4, 4, 5, 6, 6, 9, 5, 1, 9, 5], dtype=int32)
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}64}]:} \PY{c+c1}{\PYZsh{} Count number of predictions for each customer segment and population segment }
         \PY{n}{customer\PYZus{}clusters} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{Series}\PY{p}{(}\PY{n}{customers\PYZus{}predictions}\PY{p}{)}
         \PY{n}{cc} \PY{o}{=} \PY{n}{customer\PYZus{}clusters}\PY{o}{.}\PY{n}{value\PYZus{}counts}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{sort\PYZus{}index}\PY{p}{(}\PY{p}{)}
         
         \PY{n}{population\PYZus{}clusters} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{Series}\PY{p}{(}\PY{n}{azdias\PYZus{}predictions}\PY{p}{)}
         \PY{n}{pc} \PY{o}{=} \PY{n}{population\PYZus{}clusters}\PY{o}{.}\PY{n}{value\PYZus{}counts}\PY{p}{(}\PY{p}{)}\PY{o}{.}\PY{n}{sort\PYZus{}index}\PY{p}{(}\PY{p}{)}
         
         \PY{n}{df\PYZus{}stat} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{concat}\PY{p}{(}\PY{p}{[}\PY{n}{pc}\PY{p}{,} \PY{n}{cc}\PY{p}{]}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}\PY{o}{.}\PY{n}{reset\PYZus{}index}\PY{p}{(}\PY{p}{)}
         \PY{n}{df\PYZus{}stat}\PY{o}{.}\PY{n}{columns} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{cluster}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{population}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{customer}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         
         \PY{n}{total\PYZus{}customer} \PY{o}{=} \PY{n+nb}{sum}\PY{p}{(}\PY{n}{df\PYZus{}stat}\PY{o}{.}\PY{n}{customer}\PY{o}{.}\PY{n}{values}\PY{p}{)}
         \PY{n}{total\PYZus{}population} \PY{o}{=} \PY{n+nb}{sum}\PY{p}{(}\PY{n}{df\PYZus{}stat}\PY{o}{.}\PY{n}{population}\PY{o}{.}\PY{n}{values}\PY{p}{)}
         
         \PY{n}{df\PYZus{}stat}\PY{o}{.}\PY{n}{population} \PY{o}{=} \PY{n}{df\PYZus{}stat}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{population}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{apply}\PY{p}{(}\PY{k}{lambda} \PY{n}{x}\PY{p}{:}\PY{p}{(}\PY{n}{x}\PY{o}{/}\PY{n}{total\PYZus{}population}\PY{p}{)}\PY{o}{*}\PY{l+m+mi}{100}\PY{p}{)}
         \PY{n}{df\PYZus{}stat}\PY{o}{.}\PY{n}{customer} \PY{o}{=} \PY{n}{df\PYZus{}stat}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{customer}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{apply}\PY{p}{(}\PY{k}{lambda} \PY{n}{x}\PY{p}{:}\PY{p}{(}\PY{n}{x}\PY{o}{/}\PY{n}{total\PYZus{}customer}\PY{p}{)}\PY{o}{*}\PY{l+m+mi}{100}\PY{p}{)}
         
         \PY{n}{df\PYZus{}stat}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}64}]:}    cluster  population   customer
         0        0    6.897413   6.175777
         1        1   11.618974  10.924621
         2        2   13.566083  10.988737
         3        3    9.669317   7.061288
         4        4   10.140557  15.119220
         5        5    9.256665   9.543994
         6        6   11.193585  17.729446
         7        7   10.969428   9.563941
         8        8    5.987539   5.112167
         9        9   10.700440   7.780809
\end{Verbatim}
            
    Cluster 1,2,4 and 6 represent the biggest chunk for the customer
dataset. The mail order company can target people in the same cluster
from the general population. As general population of cluster 1,2,4 and
6 is similar in charcteristics with the customers, chances are more they
will respond to the promotion.

    \subsection{Part 2: Supervised Learning
Model}\label{part-2-supervised-learning-model}

Now that you've found which parts of the population are more likely to
be customers of the mail-order company, it's time to build a prediction
model. Each of the rows in the "MAILOUT" data files represents an
individual that was targeted for a mailout campaign. Ideally, we should
be able to use the demographic information from each individual to
decide whether or not it will be worth it to include that person in the
campaign.

The "MAILOUT" data has been split into two approximately equal parts,
each with almost 43 000 data rows. In this part, you can verify your
model with the "TRAIN" partition, which includes a column, "RESPONSE",
that states whether or not a person became a customer of the company
following the campaign. In the next part, you'll need to create
predictions on the "TEST" partition, where the "RESPONSE" column has
been withheld.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}65}]:} \PY{n}{mailout\PYZus{}train} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{../../data/Term2/capstone/arvato\PYZus{}data/Udacity\PYZus{}MAILOUT\PYZus{}052018\PYZus{}TRAIN.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{sep}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{;}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
/opt/conda/lib/python3.6/site-packages/IPython/core/interactiveshell.py:2785: DtypeWarning: Columns (18,19) have mixed types. Specify dtype option on import or set low\_memory=False.
  interactivity=interactivity, compiler=compiler, result=result)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}66}]:} \PY{n}{X} \PY{o}{=} \PY{n}{mailout\PYZus{}train}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RESPONSE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{)}
         \PY{n}{target} \PY{o}{=} \PY{n}{mailout\PYZus{}train}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RESPONSE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}67}]:} \PY{k}{def} \PY{n+nf}{data\PYZus{}process}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{unknowns\PYZus{}df}\PY{p}{,}\PY{n}{columns\PYZus{}to\PYZus{}drop}\PY{p}{)}\PY{p}{:}
             \PY{l+s+sd}{\PYZsq{}\PYZsq{}\PYZsq{}}
         \PY{l+s+sd}{    This function performs all the cleaning steps and return the final dataset ready for the machine learning}
         \PY{l+s+sd}{    \PYZsq{}\PYZsq{}\PYZsq{}}
             \PY{n}{df} \PY{o}{=} \PY{n}{X}\PY{o}{.}\PY{n}{copy}\PY{p}{(}\PY{n}{deep}\PY{o}{=}\PY{k+kc}{True}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Shape of dataframe \PYZhy{} rows }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s2}{ columns }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{df}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}\PY{n}{df}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}\PY{p}{)}
             \PY{n}{df} \PY{o}{=} \PY{n}{mixed\PYZus{}feature\PYZus{}handler}\PY{p}{(}\PY{n}{df}\PY{p}{)}
             \PY{n}{df} \PY{o}{=} \PY{n}{replacing\PYZus{}with\PYZus{}nan}\PY{p}{(}\PY{n}{df}\PY{p}{,}\PY{n}{unknowns\PYZus{}df}\PY{p}{)}
             \PY{n}{df}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{columns\PYZus{}to\PYZus{}drop}\PY{p}{,} \PY{n}{axis}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{inplace} \PY{o}{=} \PY{k+kc}{True}\PY{p}{)}
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Shape of dataframe after droping columns \PYZhy{} rows }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s2}{ columns }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{df}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}\PY{n}{df}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}\PY{p}{)}
             
             \PY{n}{o\PYZus{}w\PYZus{}k\PYZus{}dict} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{W}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{l+m+mi}{0}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{O}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{np}\PY{o}{.}\PY{n}{nan}\PY{p}{:}\PY{l+m+mi}{0}\PY{p}{\PYZcb{}}
             \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{OST\PYZus{}WEST\PYZus{}KZ}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{OST\PYZus{}WEST\PYZus{}KZ}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{apply}\PY{p}{(}\PY{k}{lambda} \PY{n}{x}\PY{p}{:}\PY{n}{o\PYZus{}w\PYZus{}k\PYZus{}dict}\PY{p}{[}\PY{n}{x}\PY{p}{]}\PY{p}{)}
             \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{EINGEFUEGT\PYZus{}AM}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{=}\PY{n}{pd}\PY{o}{.}\PY{n}{to\PYZus{}datetime}\PY{p}{(}\PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{EINGEFUEGT\PYZus{}AM}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{)}\PY{o}{.}\PY{n}{dt}\PY{o}{.}\PY{n}{year}
             
             \PY{c+c1}{\PYZsh{}extracting decade}
             \PY{n}{decades\PYZus{}dict} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+m+mi}{1}\PY{p}{:} \PY{l+m+mi}{40}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{:} \PY{l+m+mi}{40}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{:} \PY{l+m+mi}{50}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{:} \PY{l+m+mi}{50}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{:} \PY{l+m+mi}{60}\PY{p}{,} \PY{l+m+mi}{6}\PY{p}{:} \PY{l+m+mi}{60}\PY{p}{,} \PY{l+m+mi}{7}\PY{p}{:} \PY{l+m+mi}{60}\PY{p}{,}
                    \PY{l+m+mi}{8}\PY{p}{:} \PY{l+m+mi}{70}\PY{p}{,} \PY{l+m+mi}{9}\PY{p}{:} \PY{l+m+mi}{70}\PY{p}{,} \PY{l+m+mi}{10}\PY{p}{:} \PY{l+m+mi}{80}\PY{p}{,} \PY{l+m+mi}{11}\PY{p}{:} \PY{l+m+mi}{80}\PY{p}{,} \PY{l+m+mi}{12}\PY{p}{:} \PY{l+m+mi}{80}\PY{p}{,} \PY{l+m+mi}{13}\PY{p}{:} \PY{l+m+mi}{80}\PY{p}{,} \PY{l+m+mi}{14}\PY{p}{:} \PY{l+m+mi}{90}\PY{p}{,}
                    \PY{l+m+mi}{15}\PY{p}{:} \PY{l+m+mi}{90}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:} \PY{n}{np}\PY{o}{.}\PY{n}{nan}\PY{p}{\PYZcb{}}
         
             \PY{c+c1}{\PYZsh{}mainstream or avant\PYZhy{}garde movement}
             \PY{n}{movement\PYZus{}dict} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+m+mi}{1}\PY{p}{:} \PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{:} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{:} \PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{:} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{:} \PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{6}\PY{p}{:} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{7}\PY{p}{:} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{8}\PY{p}{:} \PY{l+m+mi}{0}\PY{p}{,}
                    \PY{l+m+mi}{9}\PY{p}{:} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{10}\PY{p}{:} \PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{11}\PY{p}{:} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{12}\PY{p}{:} \PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{13}\PY{p}{:} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+m+mi}{14}\PY{p}{:} \PY{l+m+mi}{0}\PY{p}{,} \PY{l+m+mi}{15}\PY{p}{:} \PY{l+m+mi}{1}\PY{p}{,}\PY{l+m+mi}{0}\PY{p}{:} \PY{n}{np}\PY{o}{.}\PY{n}{nan}\PY{p}{\PYZcb{}}
         
             \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{PRAEGENDE\PYZus{}JUGENDJAHRE\PYZus{}DECADE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{PRAEGENDE\PYZus{}JUGENDJAHRE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{map}\PY{p}{(}\PY{n}{decades\PYZus{}dict}\PY{p}{)}
             \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{PRAEGENDE\PYZus{}JUGENDJAHRE\PYZus{}MOVEMENT}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{PRAEGENDE\PYZus{}JUGENDJAHRE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{map}\PY{p}{(}\PY{n}{movement\PYZus{}dict}\PY{p}{)}
             
             \PY{c+c1}{\PYZsh{}Using CAMEO\PYZus{}INTL\PYZus{}2015 to create a wealth and family type feature}
             \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{WEALTH}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{CAMEO\PYZus{}INTL\PYZus{}2015}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{apply}\PY{p}{(}\PY{k}{lambda} \PY{n}{x}\PY{p}{:} \PY{n}{np}\PY{o}{.}\PY{n}{floor}\PY{p}{(}\PY{n}{pd}\PY{o}{.}\PY{n}{to\PYZus{}numeric}\PY{p}{(}\PY{n}{x}\PY{p}{)}\PY{o}{/}\PY{l+m+mi}{10}\PY{p}{)}\PY{p}{)}
             \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{LIFE\PYZus{}STAGE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{CAMEO\PYZus{}INTL\PYZus{}2015}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{apply}\PY{p}{(}\PY{k}{lambda} \PY{n}{x}\PY{p}{:} \PY{n}{pd}\PY{o}{.}\PY{n}{to\PYZus{}numeric}\PY{p}{(}\PY{n}{x}\PY{p}{)}\PY{o}{\PYZpc{}}\PY{k}{10})
         
             \PY{c+c1}{\PYZsh{}dealing with LP\PYZus{}LEBENSPHASE\PYZus{}FEIN}
             \PY{n}{life\PYZus{}stage} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+m+mi}{1}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{younger\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{middle\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{younger\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                       \PY{l+m+mi}{4}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{middle\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{advanced\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{6}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{retirement\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                       \PY{l+m+mi}{7}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{advanced\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{8}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{retirement\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{9}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{middle\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                       \PY{l+m+mi}{10}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{middle\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{11}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{advanced\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{12}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{retirement\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                       \PY{l+m+mi}{13}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{advanced\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{14}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{younger\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{15}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{advanced\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                       \PY{l+m+mi}{16}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{advanced\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{17}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{middle\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{18}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{younger\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                       \PY{l+m+mi}{19}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{advanced\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{20}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{advanced\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{21}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{middle\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                       \PY{l+m+mi}{22}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{middle\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{23}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{middle\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{24}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{middle\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                       \PY{l+m+mi}{25}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{middle\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{26}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{middle\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{27}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{middle\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                       \PY{l+m+mi}{28}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{middle\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{29}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{younger\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{30}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{younger\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                       \PY{l+m+mi}{31}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{advanced\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{32}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{advanced\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{33}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{younger\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                       \PY{l+m+mi}{34}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{younger\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{35}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{younger\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{36}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{advanced\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                       \PY{l+m+mi}{37}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{advanced\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{38}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{retirement\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{39}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{middle\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                       \PY{l+m+mi}{40}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{retirement\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}
         
             \PY{n}{fine\PYZus{}scale} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+m+mi}{1}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{low}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{2}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{low}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{3}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{average}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{4}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{average}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{5}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{low}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{6}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{low}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                       \PY{l+m+mi}{7}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{average}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{8}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{average}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{9}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{average}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{10}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{wealthy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{11}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{average}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                       \PY{l+m+mi}{12}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{average}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{13}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{top}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{14}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{average}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{15}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{low}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{16}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{average}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                       \PY{l+m+mi}{17}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{average}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{18}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{wealthy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{19}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{wealthy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{20}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{top}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{21}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{low}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                       \PY{l+m+mi}{22}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{average}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{23}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{wealthy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{24}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{low}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{25}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{average}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{26}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{average}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                       \PY{l+m+mi}{27}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{average}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{28}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{top}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{29}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{low}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{30}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{average}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{31}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{low}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                       \PY{l+m+mi}{32}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{average}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{33}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{average}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{34}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{average}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{35}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{top}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{36}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{average}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                       \PY{l+m+mi}{37}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{average}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{38}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{average}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{39}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{top}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{l+m+mi}{40}\PY{p}{:} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{top}\PY{l+s+s1}{\PYZsq{}}\PY{p}{\PYZcb{}}
         
             \PY{n}{life\PYZus{}dict} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{younger\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{middle\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{2}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{advanced\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{3}\PY{p}{,}
                     \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{retirement\PYZus{}age}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{4}\PY{p}{\PYZcb{}}
             \PY{n}{scale\PYZus{}dict} \PY{o}{=} \PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{low}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{1}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{average}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{2}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{wealthy}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{3}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{top}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:} \PY{l+m+mi}{4}\PY{p}{\PYZcb{}}
         
             \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{LP\PYZus{}LEBENSPHASE\PYZus{}FEIN\PYZus{}life\PYZus{}stage}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{LP\PYZus{}LEBENSPHASE\PYZus{}FEIN}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{map}\PY{p}{(}\PY{n}{life\PYZus{}stage}\PY{p}{)}
             \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{LP\PYZus{}LEBENSPHASE\PYZus{}FEIN\PYZus{}fine\PYZus{}scale}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{LP\PYZus{}LEBENSPHASE\PYZus{}FEIN}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{map}\PY{p}{(}\PY{n}{fine\PYZus{}scale}\PY{p}{)}
             \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{LP\PYZus{}LEBENSPHASE\PYZus{}FEIN\PYZus{}life\PYZus{}stage}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{LP\PYZus{}LEBENSPHASE\PYZus{}FEIN\PYZus{}life\PYZus{}stage}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{map}\PY{p}{(}\PY{n}{life\PYZus{}dict}\PY{p}{)}
             \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{LP\PYZus{}LEBENSPHASE\PYZus{}FEIN\PYZus{}fine\PYZus{}scale}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]} \PY{o}{=} \PY{n}{df}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{LP\PYZus{}LEBENSPHASE\PYZus{}FEIN\PYZus{}fine\PYZus{}scale}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{o}{.}\PY{n}{map}\PY{p}{(}\PY{n}{scale\PYZus{}dict}\PY{p}{)}
         
         
             \PY{n}{cols} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{PRAEGENDE\PYZus{}JUGENDJAHRE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{CAMEO\PYZus{}INTL\PYZus{}2015}\PY{l+s+s1}{\PYZsq{}} \PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{LP\PYZus{}LEBENSPHASE\PYZus{}FEIN}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{LP\PYZus{}LEBENSPHASE\PYZus{}GROB}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
             
             \PY{n}{df}\PY{o}{.}\PY{n}{drop}\PY{p}{(}\PY{n}{cols}\PY{p}{,} \PY{n}{axis} \PY{o}{=} \PY{l+m+mi}{1}\PY{p}{,} \PY{n}{inplace} \PY{o}{=} \PY{k+kc}{True}\PY{p}{)}
             
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Shape of dataframe after feature engineering \PYZhy{} rows }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s2}{ columns }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{df}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}\PY{n}{df}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}\PY{p}{)}
             
             \PY{n}{cat\PYZus{}features} \PY{o}{=} \PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{CAMEO\PYZus{}DEU\PYZus{}2015}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{CAMEO\PYZus{}DEUG\PYZus{}2015}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{CJT\PYZus{}GESAMTTYP}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{D19\PYZus{}KONSUMTYP}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                         \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{D19\PYZus{}LETZTER\PYZus{}KAUF\PYZus{}BRANCHE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{FINANZTYP}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{GEBAEUDETYP}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{GEBAEUDETYP\PYZus{}RASTER}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{GFK\PYZus{}URLAUBERTYP}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                         \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{HEALTH\PYZus{}TYP}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{KBA05\PYZus{}HERSTTEMP}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{KBA05\PYZus{}MAXHERST}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{KBA05\PYZus{}MAXSEG}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                         \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{LP\PYZus{}FAMILIE\PYZus{}FEIN}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{KBA05\PYZus{}MODTEMP}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{LP\PYZus{}FAMILIE\PYZus{}GROB}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RETOURTYP\PYZus{}BK\PYZus{}S}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}
                         \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{LP\PYZus{}STATUS\PYZus{}FEIN}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{LP\PYZus{}STATUS\PYZus{}GROB}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{NATIONALITAET\PYZus{}KZ}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{SHOPPER\PYZus{}TYP}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{ZABEOTYP}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{WOHNLAGE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}
         
             \PY{n}{df\PYZus{}cat\PYZus{}ohe} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{get\PYZus{}dummies}\PY{p}{(}\PY{n}{df}\PY{p}{,} \PY{n}{columns} \PY{o}{=} \PY{n}{cat\PYZus{}features}\PY{p}{)}
             
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Shape of dataframe after OHE \PYZhy{} rows }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s2}{ columns }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{df}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}\PY{n}{df}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}\PY{p}{)} 
             
             \PY{n}{df\PYZus{}impute} \PY{o}{=} \PY{n}{impute}\PY{p}{(}\PY{n}{df\PYZus{}cat\PYZus{}ohe}\PY{p}{)}
             
             \PY{n+nb}{print}\PY{p}{(}\PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{Shape of dataframe after imputation \PYZhy{} rows }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s2}{ columns }\PY{l+s+si}{\PYZob{}\PYZcb{}}\PY{l+s+s2}{\PYZdq{}}\PY{o}{.}\PY{n}{format}\PY{p}{(}\PY{n}{df}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{0}\PY{p}{]}\PY{p}{,}\PY{n}{df}\PY{o}{.}\PY{n}{shape}\PY{p}{[}\PY{l+m+mi}{1}\PY{p}{]}\PY{p}{)}\PY{p}{)} 
             
             \PY{k}{return} \PY{n}{df\PYZus{}impute}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}68}]:} \PY{n}{mail\PYZus{}df} \PY{o}{=} \PY{n}{data\PYZus{}process}\PY{p}{(}\PY{n}{X}\PY{p}{,}\PY{n}{unknowns\PYZus{}df}\PY{p}{,}\PY{n}{columns\PYZus{}to\PYZus{}drop}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Shape of dataframe - rows 42962 columns 366
Shape of dataframe after droping columns - rows 42962 columns 328
Shape of dataframe after feature engineering - rows 42962 columns 330
Shape of dataframe after OHE - rows 42962 columns 330
Shape of dataframe after imputation - rows 42962 columns 330

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}69}]:} \PY{n}{scaler} \PY{o}{=} \PY{n}{MinMaxScaler}\PY{p}{(}\PY{p}{)}
         \PY{n}{mail\PYZus{}df} \PY{o}{=} \PY{n}{scaler}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{mail\PYZus{}df}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{float}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \paragraph{Base Model}\label{base-model}

    I am creating a simple logistic regression as a base model. I will
create further advance model and compare their performance with the base
model.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}70}]:} \PY{n}{model\PYZus{}lr} \PY{o}{=} \PY{n}{LogisticRegression}\PY{p}{(}\PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{12}\PY{p}{)}
         
         \PY{n}{grid\PYZus{}lr} \PY{o}{=} \PY{n}{GridSearchCV}\PY{p}{(}\PY{n}{estimator}\PY{o}{=}\PY{n}{model\PYZus{}lr}\PY{p}{,} \PY{n}{param\PYZus{}grid}\PY{o}{=}\PY{p}{\PYZob{}}\PY{p}{\PYZcb{}}\PY{p}{,} \PY{n}{scoring}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{roc\PYZus{}auc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{cv}\PY{o}{=}\PY{l+m+mi}{5}\PY{p}{)}
         \PY{n}{grid\PYZus{}lr}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{mail\PYZus{}df}\PY{p}{,} \PY{n}{target}\PY{p}{)}
         \PY{n+nb}{print}\PY{p}{(}\PY{n}{grid\PYZus{}lr}\PY{o}{.}\PY{n}{best\PYZus{}score\PYZus{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
0.671431823782

    \end{Verbatim}

    AU-ROC of our simple base model is 67\%. Next, I will be creating more
advanced model to beat the base ROC.

    \paragraph{More advanced model}\label{more-advanced-model}

    I am using XG-Boost and Light GBM models as these algorithms are know
for their performance.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}71}]:} \PY{c+c1}{\PYZsh{}First XG\PYZhy{}B model}
         
         \PY{n}{xgb\PYZus{}model} \PY{o}{=} \PY{n}{xgb}\PY{o}{.}\PY{n}{XGBClassifier}\PY{p}{(}\PY{n}{eta}\PY{o}{=} \PY{l+m+mf}{0.1}\PY{p}{,} \PY{n}{gamma}\PY{o}{=} \PY{l+m+mi}{1}\PY{p}{,} \PY{n}{min\PYZus{}child\PYZus{}weight}\PY{o}{=} \PY{l+m+mi}{1}\PY{p}{,}
                                       \PY{n}{colsample\PYZus{}bytree}\PY{o}{=} \PY{l+m+mf}{0.8}\PY{p}{,} \PY{n}{max\PYZus{}bin}\PY{o}{=} \PY{l+m+mi}{256}\PY{p}{,} \PY{n}{objective}\PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{binary:logistic}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,}
                                       \PY{n}{tree\PYZus{}method}\PY{o}{=} \PY{l+s+s2}{\PYZdq{}}\PY{l+s+s2}{hist}\PY{l+s+s2}{\PYZdq{}}\PY{p}{,} \PY{n}{silent}\PY{o}{=} \PY{l+m+mi}{1}\PY{p}{,} \PY{n}{base\PYZus{}score}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{,} 
                                       \PY{n}{eval\PYZus{}metric}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{auc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{booster}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gbtree}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{learning\PYZus{}rate}\PY{o}{=}\PY{l+m+mf}{0.005}\PY{p}{,}
                                       \PY{n}{max\PYZus{}depth}\PY{o}{=}\PY{l+m+mi}{5}\PY{p}{,} \PY{n}{missing}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,}\PY{n}{n\PYZus{}estimators}\PY{o}{=}\PY{l+m+mi}{500}\PY{p}{,} \PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}
                                       \PY{n}{nthread}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{reg\PYZus{}alpha}\PY{o}{=}\PY{l+m+mf}{1e\PYZhy{}09}\PY{p}{,} 
                                       \PY{n}{reg\PYZus{}lambda}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{scale\PYZus{}pos\PYZus{}weight}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{seed}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{subsample}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}72}]:} \PY{n}{xgb\PYZus{}model}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{mail\PYZus{}df}\PY{p}{,} \PY{n}{target}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}72}]:} XGBClassifier(base\_score=0.5, booster='gbtree', colsample\_bylevel=1,
                colsample\_bynode=1, colsample\_bytree=0.8, eta=0.1,
                eval\_metric='auc', gamma=1, gpu\_id=-1, importance\_type='gain',
                interaction\_constraints=None, learning\_rate=0.005, max\_bin=256,
                max\_delta\_step=0, max\_depth=5, min\_child\_weight=1, missing=nan,
                monotone\_constraints=None, n\_estimators=500, n\_jobs=-1, nthread=-1,
                num\_parallel\_tree=1, objective='binary:logistic', random\_state=0,
                reg\_alpha=1e-09, reg\_lambda=1, scale\_pos\_weight=1, seed=1, silent=1,
                subsample=0.5, tree\_method='hist', validate\_parameters=False,
                verbosity=None)
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}79}]:} \PY{c+c1}{\PYZsh{}Second XGB model}
         
         \PY{n}{xgb\PYZus{}model2} \PY{o}{=} \PY{n}{xgb}\PY{o}{.}\PY{n}{XGBClassifier}\PY{p}{(}\PY{n}{base\PYZus{}score}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{,} \PY{n}{booster}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gbtree}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{colsample\PYZus{}bylevel}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,}
                                       \PY{n}{colsample\PYZus{}bytree}\PY{o}{=}\PY{l+m+mf}{0.687}\PY{p}{,} \PY{n}{eval\PYZus{}metric}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{auc}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{gamma}\PY{o}{=}\PY{l+m+mf}{1.0}\PY{p}{,}
                                       \PY{n}{learning\PYZus{}rate}\PY{o}{=}\PY{l+m+mf}{0.014}\PY{p}{,} \PY{n}{max\PYZus{}delta\PYZus{}step}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{max\PYZus{}depth}\PY{o}{=}\PY{l+m+mi}{7}\PY{p}{,}
                                       \PY{n}{min\PYZus{}child\PYZus{}weight}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{missing}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,} \PY{n}{n\PYZus{}estimators}\PY{o}{=}\PY{l+m+mi}{500}\PY{p}{,} 
                                       \PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{nthread}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,} \PY{n}{objective}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{binary:logistic}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} 
                                       \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,}\PY{n}{reg\PYZus{}alpha}\PY{o}{=}\PY{l+m+mf}{1e\PYZhy{}09}\PY{p}{,} \PY{n}{reg\PYZus{}lambda}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} 
                                       \PY{n}{scale\PYZus{}pos\PYZus{}weight}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{seed}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{subsample}\PY{o}{=}\PY{l+m+mf}{0.5}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}80}]:} \PY{n}{xgb\PYZus{}model2}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{mail\PYZus{}df}\PY{p}{,} \PY{n}{target}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}80}]:} XGBClassifier(base\_score=0.5, booster='gbtree', colsample\_bylevel=1,
                colsample\_bynode=1, colsample\_bytree=0.687, eval\_metric='auc',
                gamma=1.0, gpu\_id=-1, importance\_type='gain',
                interaction\_constraints=None, learning\_rate=0.014, max\_delta\_step=0,
                max\_depth=7, min\_child\_weight=1, missing=nan,
                monotone\_constraints=None, n\_estimators=500, n\_jobs=-1, nthread=-1,
                num\_parallel\_tree=1, objective='binary:logistic', random\_state=0,
                reg\_alpha=1e-09, reg\_lambda=1, scale\_pos\_weight=1, seed=1,
                subsample=0.5, tree\_method=None, validate\_parameters=False,
                verbosity=None)
\end{Verbatim}
            
    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}81}]:} \PY{c+c1}{\PYZsh{}First LightGBM model}
         
         \PY{n}{lgbm\PYZus{}model} \PY{o}{=} \PY{n}{lgb}\PY{o}{.}\PY{n}{LGBMClassifier}\PY{p}{(}\PY{n}{application}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{binary}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{boosting\PYZus{}type}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{gbdt}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{class\PYZus{}weight}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,}
                                         \PY{n}{colsample\PYZus{}bytree}\PY{o}{=}\PY{l+m+mf}{1.0}\PY{p}{,} \PY{n}{importance\PYZus{}type}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{split}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,}\PY{n}{learning\PYZus{}rate}\PY{o}{=}\PY{l+m+mf}{0.005}\PY{p}{,} 
                                         \PY{n}{max\PYZus{}bin}\PY{o}{=}\PY{l+m+mi}{500}\PY{p}{,} \PY{n}{max\PYZus{}depth}\PY{o}{=}\PY{l+m+mi}{5}\PY{p}{,}\PY{n}{min\PYZus{}child\PYZus{}samples}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,} 
                                         \PY{n}{min\PYZus{}child\PYZus{}weight}\PY{o}{=}\PY{l+m+mi}{1}\PY{p}{,}\PY{n}{min\PYZus{}data\PYZus{}in\PYZus{}leaf}\PY{o}{=}\PY{l+m+mi}{32}\PY{p}{,} \PY{n}{min\PYZus{}split\PYZus{}gain}\PY{o}{=}\PY{l+m+mf}{0.0}\PY{p}{,} 
                                         \PY{n}{n\PYZus{}estimators}\PY{o}{=}\PY{l+m+mi}{256}\PY{p}{,} \PY{n}{n\PYZus{}jobs}\PY{o}{=}\PY{o}{\PYZhy{}}\PY{l+m+mi}{1}\PY{p}{,} \PY{n}{num\PYZus{}leaves}\PY{o}{=}\PY{l+m+mi}{94}\PY{p}{,} 
                                         \PY{n}{objective}\PY{o}{=}\PY{k+kc}{None}\PY{p}{,} \PY{n}{random\PYZus{}state}\PY{o}{=}\PY{l+m+mi}{32}\PY{p}{,}\PY{n}{reg\PYZus{}alpha}\PY{o}{=}\PY{l+m+mf}{1.0}\PY{p}{,} 
                                         \PY{n}{reg\PYZus{}lambda}\PY{o}{=}\PY{l+m+mf}{1e\PYZhy{}09}\PY{p}{,} \PY{n}{scale\PYZus{}pos\PYZus{}weight}\PY{o}{=}\PY{l+m+mf}{90.0}\PY{p}{,} \PY{n}{silent}\PY{o}{=}\PY{k+kc}{True}\PY{p}{,} 
                                         \PY{n}{subsample}\PY{o}{=}\PY{l+m+mf}{1.0}\PY{p}{,} \PY{n}{subsample\PYZus{}for\PYZus{}bin}\PY{o}{=}\PY{l+m+mi}{200000}\PY{p}{,} \PY{n}{subsample\PYZus{}freq}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{,} \PY{n}{verbose}\PY{o}{=}\PY{l+m+mi}{0}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}82}]:} \PY{n}{lgbm\PYZus{}model}\PY{o}{.}\PY{n}{fit}\PY{p}{(}\PY{n}{mail\PYZus{}df}\PY{p}{,} \PY{n}{target}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}82}]:} LGBMClassifier(application='binary', boosting\_type='gbdt', class\_weight=None,
                 colsample\_bytree=1.0, importance\_type='split', learning\_rate=0.005,
                 max\_bin=500, max\_depth=5, min\_child\_samples=0, min\_child\_weight=1,
                 min\_data\_in\_leaf=32, min\_split\_gain=0.0, n\_estimators=256,
                 n\_jobs=-1, num\_leaves=94, objective=None, random\_state=32,
                 reg\_alpha=1.0, reg\_lambda=1e-09, scale\_pos\_weight=90.0,
                 silent=True, subsample=1.0, subsample\_for\_bin=200000,
                 subsample\_freq=0, verbose=0)
\end{Verbatim}
            
    \subsection{Part 3: Kaggle Competition}\label{part-3-kaggle-competition}

Now that you've created a model to predict which individuals are most
likely to respond to a mailout campaign, it's time to test that model in
competition through Kaggle. If you click on the link
\href{http://www.kaggle.com/t/21e6d45d4c574c7fa2d868f0e8c83140}{here},
you'll be taken to the competition page where, if you have a Kaggle
account, you can enter. If you're one of the top performers, you may
have the chance to be contacted by a hiring manager from Arvato or
Bertelsmann for an interview!

Your entry to the competition should be a CSV file with two columns. The
first column should be a copy of "LNR", which acts as an ID number for
each individual in the "TEST" partition. The second column, "RESPONSE",
should be some measure of how likely each individual became a customer
-- this might not be a straightforward probability. As you should have
found in Part 2, there is a large output class imbalance, where most
individuals did not respond to the mailout. Thus, predicting individual
classes and using accuracy does not seem to be an appropriate
performance evaluation method. Instead, the competition will be using
AUC to evaluate performance. The exact values of the "RESPONSE" column
do not matter as much: only that the higher values try to capture as
many of the actual customers as possible, early in the ROC curve sweep.

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}83}]:} \PY{n}{mailout\PYZus{}test} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{read\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{../../data/Term2/capstone/arvato\PYZus{}data/Udacity\PYZus{}MAILOUT\PYZus{}052018\PYZus{}TEST.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{sep}\PY{o}{=}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{;}\PY{l+s+s1}{\PYZsq{}}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
/opt/conda/lib/python3.6/site-packages/IPython/core/interactiveshell.py:2785: DtypeWarning: Columns (18,19) have mixed types. Specify dtype option on import or set low\_memory=False.
  interactivity=interactivity, compiler=compiler, result=result)

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}84}]:} \PY{n}{mail\PYZus{}test} \PY{o}{=} \PY{n}{data\PYZus{}process}\PY{p}{(}\PY{n}{mailout\PYZus{}test}\PY{p}{,}\PY{n}{unknowns\PYZus{}df}\PY{p}{,}\PY{n}{columns\PYZus{}to\PYZus{}drop}\PY{p}{)}
         \PY{n}{mail\PYZus{}test} \PY{o}{=} \PY{n}{scaler}\PY{o}{.}\PY{n}{fit\PYZus{}transform}\PY{p}{(}\PY{n}{mail\PYZus{}test}\PY{o}{.}\PY{n}{astype}\PY{p}{(}\PY{n+nb}{float}\PY{p}{)}\PY{p}{)}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
Shape of dataframe - rows 42833 columns 366
Shape of dataframe after droping columns - rows 42833 columns 328
Shape of dataframe after feature engineering - rows 42833 columns 330
Shape of dataframe after OHE - rows 42833 columns 330
Shape of dataframe after imputation - rows 42833 columns 330

    \end{Verbatim}

    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}85}]:} \PY{n}{predictions\PYZus{}xgb1} \PY{o}{=} \PY{n}{xgb\PYZus{}model}\PY{o}{.}\PY{n}{predict\PYZus{}proba}\PY{p}{(}\PY{n}{mail\PYZus{}test}\PY{p}{)}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}
         \PY{n}{predictions\PYZus{}xgb2} \PY{o}{=} \PY{n}{xgb\PYZus{}model2}\PY{o}{.}\PY{n}{predict\PYZus{}proba}\PY{p}{(}\PY{n}{mail\PYZus{}test}\PY{p}{)}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}
         \PY{n}{predictions\PYZus{}lgbm} \PY{o}{=} \PY{n}{lgbm\PYZus{}model}\PY{o}{.}\PY{n}{predict\PYZus{}proba}\PY{p}{(}\PY{n}{mail\PYZus{}test}\PY{p}{)}\PY{p}{[}\PY{p}{:}\PY{p}{,}\PY{l+m+mi}{1}\PY{p}{]}
\end{Verbatim}


    \begin{Verbatim}[commandchars=\\\{\}]
{\color{incolor}In [{\color{incolor}86}]:} \PY{n}{submission} \PY{o}{=} \PY{n}{pd}\PY{o}{.}\PY{n}{DataFrame}\PY{p}{(}\PY{p}{\PYZob{}}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{LNR}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{mailout\PYZus{}test}\PY{p}{[}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{LNR}\PY{l+s+s1}{\PYZsq{}}\PY{p}{]}\PY{p}{,} \PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{RESPONSE}\PY{l+s+s1}{\PYZsq{}}\PY{p}{:}\PY{n}{predictions\PYZus{}xgb1}\PY{p}{\PYZcb{}}\PY{p}{)}
         \PY{n}{submission}\PY{o}{.}\PY{n}{to\PYZus{}csv}\PY{p}{(}\PY{l+s+s1}{\PYZsq{}}\PY{l+s+s1}{submission.csv}\PY{l+s+s1}{\PYZsq{}}\PY{p}{,} \PY{n}{index} \PY{o}{=} \PY{k+kc}{False}\PY{p}{)}
         \PY{n}{submission}\PY{o}{.}\PY{n}{head}\PY{p}{(}\PY{p}{)}
\end{Verbatim}


\begin{Verbatim}[commandchars=\\\{\}]
{\color{outcolor}Out[{\color{outcolor}86}]:}     LNR  RESPONSE
         0  1754  0.070031
         1  1770  0.070659
         2  1465  0.044165
         3  1470  0.045033
         4  1478  0.047944
\end{Verbatim}
            

    % Add a bibliography block to the postdoc
    
    
    
    \end{document}
